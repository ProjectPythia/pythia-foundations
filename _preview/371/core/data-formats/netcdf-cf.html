
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>NetCDF and CF: The Basics &#8212; Pythia Foundations</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet">
  <link href="../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-pythia-theme.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script src="../../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Xarray" href="../xarray.html" />
    <link rel="prev" title="Data Formats" href="../data-formats.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-G57FLM9M46"></script>
<script>
                    window.dataLayer = window.dataLayer || [];
                    function gtag(){ dataLayer.push(arguments); }
                    gtag('js', new Date());
                    gtag('config', 'G-G57FLM9M46');
                </script>

  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="132">
    <div class="container-fluid" id="shim"></div>
    <div class="container-fluid" id="banner"></div>
    <nav class="navbar navbar-dark navbar-expand-lg bg-dark fixed-top bd-navbar shadow" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="https://projectpythia.org">
  <img src="../../_static/pythia_logo-white-rtext.svg" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class=" collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
  
  <li class="nav-item">
    
    
    
    <a class="nav-link nav-internal" href="https://projectpythia.org">Home</a>
  </li>
  
  <li class="nav-item">
    
    
    
    <a class="nav-link nav-internal" href="https://foundations.projectpythia.org">Foundations</a>
  </li>
  
  <li class="nav-item">
    
    
    
    <a class="nav-link nav-internal" href="https://cookbooks.projectpythia.org">Cookbooks</a>
  </li>
  
  <li class="nav-item">
    
    
    
    <a class="nav-link nav-internal" href="https://projectpythia.org/resource-gallery.html">Resources</a>
  </li>
  
  <li class="nav-item">
    
    
    
    <a class="nav-link nav-internal" href="https://projectpythia.org/index.html#join-us">Community</a>
  </li>
  
  
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/ProjectPythia" rel="noopener" target="_blank" title="GitHub">
            <span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://twitter.com/project_pythia" rel="noopener" target="_blank" title="Twitter">
            <span><i class="fab fa-twitter-square"></i></span>
            <label class="sr-only">Twitter</label>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://www.youtube.com/channel/UCoZPBqJal5uKpO8ZiwzavCw" rel="noopener" target="_blank" title="YouTube">
            <span><i class="fab fa-youtube-square"></i></span>
            <label class="sr-only">YouTube</label>
          </a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    <div class="container-xl">
      <div class="row">
        
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../landing-page.html">
   Pythia Foundations
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Preamble
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../preamble/how-to-use.html">
   How to Use This Book
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Foundational skills
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../foundations/overview.html">
   Overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../foundations/why-python.html">
   Why Python?
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../foundations/getting-started-python.html">
   Getting Started with Python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../foundations/quickstart.html">
     Quickstart: Zero to Python
    </a>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../foundations/how-to-run-python.html">
     Installing and Running Python
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
    <label for="toctree-checkbox-2">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../foundations/terminal.html">
       Python in the Terminal
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../foundations/jupyter.html">
       Python in Jupyter
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../foundations/conda.html">
       Installing and Managing Python with Conda
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../foundations/getting-started-jupyter.html">
   Getting Started with Jupyter
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../foundations/jupyterlab.html">
     JupyterLab
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../foundations/markdown.html">
     Formatted Text in the Notebook with Markdown
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../foundations/getting-started-github.html">
   Getting Started with GitHub
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../foundations/github/what-is-github.html">
     What is GitHub?
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../foundations/github/github-repos.html">
     GitHub Repositories
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../foundations/github/github-issues.html">
     Issues and Discussions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../foundations/github/github-cloning-forking.html">
     Cloning and Forking a Repository
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../foundations/github/github-setup-advanced.html">
     Configuring Your GitHub Account
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../foundations/github/basic-git.html">
     Basic Version Control with
     <em>
      git
     </em>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../foundations/github/git-branches.html">
     Git Branches
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../foundations/github/github-pull-request.html">
     Opening a Pull Request on GitHub
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../foundations/github/review-pr.html">
     Reviewing Pull Requests
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../foundations/github/github-workflows.html">
     GitHub Workflows
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../foundations/github/contribute-to-pythia.html">
     Contribute to Project Pythia via GitHub
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Core Scientific Python packages
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../overview.html">
   Overview
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../numpy.html">
   NumPy
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../numpy/numpy-basics.html">
     NumPy Basics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../numpy/intermediate-numpy.html">
     Intermediate NumPy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../numpy/numpy-broadcasting.html">
     NumPy Broadcasting
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../matplotlib.html">
   Matplotlib
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../matplotlib/matplotlib-basics.html">
     Matplotlib Basics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../matplotlib/histograms-piecharts-animation.html">
     Histograms, Pie Charts, and Animations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../matplotlib/annotations-colorbars-layouts.html">
     Annotations, Colorbars, and Advanced Layouts
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../cartopy.html">
   Cartopy
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../cartopy/cartopy.html">
     Introduction to Cartopy
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../datetime.html">
   Datetime
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../datetime/datetime.html">
     Times and Dates in Python
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../pandas.html">
   Pandas
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../pandas/pandas.html">
     Introduction to Pandas
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../data-formats.html">
   Data Formats
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     NetCDF and CF: The Basics
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../xarray.html">
   Xarray
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
  <label for="toctree-checkbox-11">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../xarray/xarray-intro.html">
     Introduction to Xarray
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../xarray/computation-masking.html">
     Computations and Masks with Xarray
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../xarray/enso-xarray.html">
     Calculating ENSO with Xarray
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../xarray/dask-arrays-xarray.html">
     Dask Arrays with Xarray
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Appendix
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../appendix/how-to-contribute.html">
   Pythia Foundations Contributor’s Guide
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
  <label for="toctree-checkbox-12">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../appendix/template.html">
     Project Pythia Notebook Template
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Theme by <a href="https://projectpythia.org">Project Pythia</a>.<br><br>
All code in Pythia Foundations is licensed under Apache 2.0. All other non-code content is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">Creative Commons BY 4.0 (CC BY 4.0)</a>.<br><br>
We want your feedback! Fill out this <a href="https://docs.google.com/forms/d/e/1FAIpQLSeVa1TC9xM-dk7qIE2e8bsgSrIP82yYDNw3wew3J46eREJa4w/viewform?usp=sf_link">Google Form</a>
or see our <a href="https://foundations.projectpythia.org/appendix/how-to-contribute.html">Contributor's Guide</a>.

</div>

</div>

        

        <main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main"><div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/core/data-formats/netcdf-cf.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/ProjectPythia/pythia-foundations"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/ProjectPythia/pythia-foundations/issues/new?title=Issue%20on%20page%20%2Fcore/data-formats/netcdf-cf.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/ProjectPythia/pythia-foundations/edit/main/core/data-formats/netcdf-cf.ipynb"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/ProjectPythia/pythia-foundations/main?urlpath=lab/tree/core/data-formats/netcdf-cf.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> On this page
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#overview">
   Overview
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#prerequisites">
   Prerequisites
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#imports">
   Imports
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#gridded-data">
   Gridded Data
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#creating-the-file-and-dimensions">
     Creating the file and dimensions
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#creating-and-filling-a-variable">
     Creating and filling a variable
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#coordinate-variables">
     Coordinate variables
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#auxilliary-coordinates">
     Auxilliary Coordinates
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#coordinate-system-information">
     Coordinate System Information
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cell-bounds">
     Cell Bounds
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#observational-data">
   Observational Data
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#creation-and-basic-setup">
     Creation and basic setup
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#station-ids">
     Station IDs
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#writing-the-field">
     Writing the field
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#summary">
   Summary
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#whats-next">
     What’s Next?
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#resources-and-references">
   Resources and References
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
          <div id="main-content" class="row">
            <div class="col-12 col-md-9 pl-md-3 pr-md-0">
              
              <div>
                
  <p><img alt="NetCDF Logo" src="https://www.unidata.ucar.edu/images/logos/netcdf-400x400.png" /></p>
<div class="tex2jax_ignore mathjax_ignore section" id="netcdf-and-cf-the-basics">
<h1>NetCDF and CF: The Basics<a class="headerlink" href="#netcdf-and-cf-the-basics" title="Permalink to this headline"><i class="fas fa-link"></i></a></h1>
<hr class="docutils" />
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline"><i class="fas fa-link"></i></a></h2>
<p>This notebook will introduce you to the basics of Climate and Forecasting (CF) metadata for netCDF data files. Along with an introduction to netCDF, we will introduce the CF data model and discuss some netCDF implementation details to consider when deciding how to write data with CF and netCDF. We will cover the following,</p>
<ol class="simple">
<li><p>Demonstrating gridded data</p></li>
<li><p>Demonstrating observational data</p></li>
</ol>
</div>
<div class="section" id="prerequisites">
<h2>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this headline"><i class="fas fa-link"></i></a></h2>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Concepts</p></th>
<th class="head"><p>Importance</p></th>
<th class="head"><p>Notes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="../numpy/numpy-basics.html"><span class="doc std std-doc">Numpy Basics</span></a></p></td>
<td><p>Necessary</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../datetime.html"><span class="doc std std-doc">Datetime</span></a></p></td>
<td><p>Necessary</p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p><strong>Time to learn</strong>: 50 minutes</p></li>
</ul>
</div>
<hr class="docutils" />
<div class="section" id="imports">
<h2>Imports<a class="headerlink" href="#imports" title="Permalink to this headline"><i class="fas fa-link"></i></a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">cftime</span> <span class="kn">import</span> <span class="n">date2num</span>
<span class="kn">from</span> <span class="nn">netCDF4</span> <span class="kn">import</span> <span class="n">Dataset</span>
<span class="kn">from</span> <span class="nn">pyproj</span> <span class="kn">import</span> <span class="n">Proj</span>
</pre></div>
</div>
</div>
</div>
<p><a name="gridded"></a></p>
</div>
<div class="section" id="gridded-data">
<h2>Gridded Data<a class="headerlink" href="#gridded-data" title="Permalink to this headline"><i class="fas fa-link"></i></a></h2>
<p>Let’s say we’re working with some numerical weather forecast model output. Let’s walk through the steps necessary to store this data in netCDF, using the Climate and Forecasting metadata conventions to ensure that our data are available to as many tools as possible.</p>
<p>To start, let’s assume the following about our data:</p>
<ul class="simple">
<li><p>There are three spatial dimensions (<code class="docutils literal notranslate"><span class="pre">x</span></code>, <code class="docutils literal notranslate"><span class="pre">y</span></code>, and <code class="docutils literal notranslate"><span class="pre">press</span></code>) and one temporal dimension (<code class="docutils literal notranslate"><span class="pre">times</span></code>)</p></li>
<li><p>The native coordinate system of the model is on a regular 3km x 3km grid (<code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code>) that represents the Earth on a Lambert conformal projection.</p></li>
<li><p>The vertical dimension (<code class="docutils literal notranslate"><span class="pre">press</span></code>) consists of several discrete pressure levels in units of hPa.</p></li>
<li><p>The time dimension consists of twelve consecutive hours (<code class="docutils literal notranslate"><span class="pre">times</span></code>), beginning at 2200 UTC on the current day.</p></li>
</ul>
<p>We’ll also go ahead and generate our dimensional arrays:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">start</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">hour</span><span class="o">=</span><span class="mi">22</span><span class="p">,</span> <span class="n">minute</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">second</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">microsecond</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">start</span> <span class="o">+</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="n">h</span><span class="p">)</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">13</span><span class="p">)])</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">150</span><span class="p">,</span> <span class="mi">153</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

<span class="n">press</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">925</span><span class="p">,</span> <span class="mi">850</span><span class="p">,</span> <span class="mi">700</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">250</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>Next, let’s create a multidimensional array of random values to hold our variable of interest … in this case, temperature (<code class="docutils literal notranslate"><span class="pre">temps</span></code>). Note that the dimensions correspond to the ones we just created above.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">times</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">press</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="creating-the-file-and-dimensions">
<h3>Creating the file and dimensions<a class="headerlink" href="#creating-the-file-and-dimensions" title="Permalink to this headline"><i class="fas fa-link"></i></a></h3>
<p>The first step is to create a new file in netCDF format and set up the shared dimensions we’ll be using in the file. We’ll be using the <code class="docutils literal notranslate"><span class="pre">netCDF4</span></code> library to do all of the requisite netCDF API calls.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nc</span> <span class="o">=</span> <span class="n">Dataset</span><span class="p">(</span><span class="s1">&#39;forecast_model.nc&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;NETCDF4_CLASSIC&#39;</span><span class="p">,</span> <span class="n">diskless</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="admonition alert alert-info">
<p class="admonition-title">Info</p>
<p>This creates the netCDF file in memory. If you wish to write the file to disk you can add the <code>persist=True</code> argument or remove the <code>diskless=True</code> argument.</p>
</div>
<div class="admonition alert alert-danger">
<p class="admonition-title">Danger</p>
<p>If you open an existing file with <code>‘w’</code> as the second argument, any data already in the file will be overwritten. If you would like to edit or add to the file, open it using <code>‘a’</code> as the second argument.</p>
</div>
<p>We’re going to start by adding some global attribute metadata. These are recommendations from the standard (not required), but they’re easy to add and help users keep the data straight, so let’s go ahead and do it.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nc</span><span class="o">.</span><span class="n">Conventions</span> <span class="o">=</span> <span class="s1">&#39;CF-1.7&#39;</span>
<span class="n">nc</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Forecast model run&#39;</span>
<span class="n">nc</span><span class="o">.</span><span class="n">institution</span> <span class="o">=</span> <span class="s1">&#39;Unidata&#39;</span>
<span class="n">nc</span><span class="o">.</span><span class="n">source</span> <span class="o">=</span> <span class="s1">&#39;WRF-1.5&#39;</span>
<span class="n">nc</span><span class="o">.</span><span class="n">history</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">())</span> <span class="o">+</span> <span class="s1">&#39; Python&#39;</span>
<span class="n">nc</span><span class="o">.</span><span class="n">references</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="n">nc</span><span class="o">.</span><span class="n">comment</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</pre></div>
</div>
</div>
</div>
<p>At this point, this is the plain-text representation of this netCDF dataset:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">netcdf</span> <span class="n">forecast_model</span> <span class="p">{</span>
  <span class="n">attributes</span><span class="p">:</span>
    <span class="p">:</span><span class="n">Conventions</span> <span class="o">=</span> <span class="s2">&quot;CF-1.7&quot;</span> <span class="p">;</span>
    <span class="p">:</span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Forecast model run&quot;</span> <span class="p">;</span>
    <span class="p">:</span><span class="n">institution</span> <span class="o">=</span> <span class="s2">&quot;Unidata&quot;</span> <span class="p">;</span>
    <span class="p">:</span><span class="n">source</span> <span class="o">=</span> <span class="s2">&quot;WRF-1.5&quot;</span> <span class="p">;</span>
    <span class="p">:</span><span class="n">history</span> <span class="o">=</span> <span class="s2">&quot;2019-07-16 02:21:52.005718 Python&quot;</span> <span class="p">;</span>
    <span class="p">:</span><span class="n">references</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span> <span class="p">;</span>
    <span class="p">:</span><span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span> <span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition alert alert-info">
<p class="admonition-title">Info</p>
<p>This plain-text representation is known as netCDF Common Data Format Language, or <strong>CDL</strong>.</p>
</div>
<p>Next, before adding variables to the file to define each of the data fields in this file, we need to define the dimensions that exist in this data set. We set each of <code class="docutils literal notranslate"><span class="pre">x</span></code>, <code class="docutils literal notranslate"><span class="pre">y</span></code>, and <code class="docutils literal notranslate"><span class="pre">pressure</span></code> to the size of the corresponding array. We set <code class="docutils literal notranslate"><span class="pre">forecast_time</span></code> to be an “unlimited” dimension, which allows the dataset to grow along that dimension if we write additional data to it later.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nc</span><span class="o">.</span><span class="n">createDimension</span><span class="p">(</span><span class="s1">&#39;forecast_time&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">nc</span><span class="o">.</span><span class="n">createDimension</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
<span class="n">nc</span><span class="o">.</span><span class="n">createDimension</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
<span class="n">nc</span><span class="o">.</span><span class="n">createDimension</span><span class="p">(</span><span class="s1">&#39;pressure&#39;</span><span class="p">,</span> <span class="n">press</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
<span class="n">nc</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;netCDF4._netCDF4.Dataset&#39;&gt;
root group (NETCDF4_CLASSIC data model, file format HDF5):
    Conventions: CF-1.7
    title: Forecast model run
    institution: Unidata
    source: WRF-1.5
    history: 2023-02-07 06:24:49.053382 Python
    references: 
    comment: 
    dimensions(sizes): forecast_time(0), x(101), y(67), pressure(7)
    variables(dimensions): 
    groups: 
</pre></div>
</div>
</div>
</div>
<p>The CDL representation now shows our dimensions:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">netcdf</span> <span class="n">forecast_model</span> <span class="p">{</span>
  <span class="n">dimensions</span><span class="p">:</span>
    <span class="n">forecast_time</span> <span class="o">=</span> <span class="n">UNLIMITED</span> <span class="p">(</span><span class="n">currently</span> <span class="mi">13</span><span class="p">)</span> <span class="p">;</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mi">101</span> <span class="p">;</span>
    <span class="n">y</span> <span class="o">=</span> <span class="mi">67</span> <span class="p">;</span>
    <span class="n">pressure</span> <span class="o">=</span> <span class="mi">7</span> <span class="p">;</span>
  <span class="n">attributes</span><span class="p">:</span>
    <span class="p">:</span><span class="n">Conventions</span> <span class="o">=</span> <span class="s2">&quot;CF-1.7&quot;</span> <span class="p">;</span>
    <span class="p">:</span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Forecast model run&quot;</span> <span class="p">;</span>
    <span class="p">:</span><span class="n">institution</span> <span class="o">=</span> <span class="s2">&quot;Unidata&quot;</span> <span class="p">;</span>
    <span class="p">:</span><span class="n">source</span> <span class="o">=</span> <span class="s2">&quot;WRF-1.5&quot;</span> <span class="p">;</span>
    <span class="p">:</span><span class="n">history</span> <span class="o">=</span> <span class="s2">&quot;2019-07-16 02:21:52.005718 Python&quot;</span> <span class="p">;</span>
    <span class="p">:</span><span class="n">references</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span> <span class="p">;</span>
    <span class="p">:</span><span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span> <span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="creating-and-filling-a-variable">
<h3>Creating and filling a variable<a class="headerlink" href="#creating-and-filling-a-variable" title="Permalink to this headline"><i class="fas fa-link"></i></a></h3>
<p>So far, all we’ve done is outlined basic information about our dataset: broad metadata and the dimensions of our dataset. Now we create a <code class="docutils literal notranslate"><span class="pre">netCDF4</span> <span class="pre">variable</span></code> to hold one particular data field for our dataset, in this case the forecast air temperature. When defining this variable, we specify the datatype for the values being stored, the relevant dimensions, as well as enable optional <code class="docutils literal notranslate"><span class="pre">zlib</span></code>-based compression.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temps_var</span> <span class="o">=</span> <span class="n">nc</span><span class="o">.</span><span class="n">createVariable</span><span class="p">(</span>
    <span class="s1">&#39;Temperature&#39;</span><span class="p">,</span>
    <span class="n">datatype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span>
    <span class="n">dimensions</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;forecast_time&#39;</span><span class="p">,</span> <span class="s1">&#39;pressure&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">),</span>
    <span class="n">zlib</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now that we have the variable, we tell Python to write our array of data to it.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temps_var</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">temps</span>
<span class="n">temps_var</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;netCDF4._netCDF4.Variable&#39;&gt;
float32 Temperature(forecast_time, pressure, y, x)
unlimited dimensions: forecast_time
current shape = (13, 7, 67, 101)
filling on, default _FillValue of 9.969209968386869e+36 used
</pre></div>
</div>
</div>
</div>
<p>If instead we wanted to write data sporadically, like once per time step, we could do that instead (though the <code class="docutils literal notranslate"><span class="pre">for</span></code> loop below might actually be at a higher level in the program:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">next_slice</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">temp_slice</span> <span class="ow">in</span> <span class="n">temps</span><span class="p">:</span>
    <span class="n">temps_var</span><span class="p">[</span><span class="n">next_slice</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp_slice</span>
    <span class="n">next_slice</span> <span class="o">+=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
<p>At this point, this is the CDL representation of our dataset:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">netcdf</span> <span class="n">forecast_model</span> <span class="p">{</span>
  <span class="n">dimensions</span><span class="p">:</span>
    <span class="n">forecast_time</span> <span class="o">=</span> <span class="n">UNLIMITED</span> <span class="p">(</span><span class="n">currently</span> <span class="mi">13</span><span class="p">)</span> <span class="p">;</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mi">101</span> <span class="p">;</span>
    <span class="n">y</span> <span class="o">=</span> <span class="mi">67</span> <span class="p">;</span>
    <span class="n">pressure</span> <span class="o">=</span> <span class="mi">7</span> <span class="p">;</span>
  <span class="n">variables</span><span class="p">:</span>
    <span class="nb">float</span> <span class="n">Temperature</span><span class="p">(</span><span class="n">forecast_time</span><span class="p">,</span> <span class="n">pressure</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="p">;</span>
  <span class="n">attributes</span><span class="p">:</span>
    <span class="p">:</span><span class="n">Conventions</span> <span class="o">=</span> <span class="s2">&quot;CF-1.7&quot;</span> <span class="p">;</span>
    <span class="p">:</span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Forecast model run&quot;</span> <span class="p">;</span>
    <span class="p">:</span><span class="n">institution</span> <span class="o">=</span> <span class="s2">&quot;Unidata&quot;</span> <span class="p">;</span>
    <span class="p">:</span><span class="n">source</span> <span class="o">=</span> <span class="s2">&quot;WRF-1.5&quot;</span> <span class="p">;</span>
    <span class="p">:</span><span class="n">history</span> <span class="o">=</span> <span class="s2">&quot;2019-07-16 02:21:52.005718 Python&quot;</span> <span class="p">;</span>
    <span class="p">:</span><span class="n">references</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span> <span class="p">;</span>
    <span class="p">:</span><span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span> <span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>We can also add attributes to this variable to define metadata. The CF conventions require a <code class="docutils literal notranslate"><span class="pre">units</span></code> attribute to be set for all variables that represent a dimensional quantity. The value of this attribute needs to be parsable by the <a class="reference external" href="https://www.unidata.ucar.edu/software/udunits/">UDUNITS</a> library. Here we set it to a value of <code class="docutils literal notranslate"><span class="pre">'Kelvin'</span></code>. We also set the standard (optional) attributes of <code class="docutils literal notranslate"><span class="pre">long_name</span></code> and <code class="docutils literal notranslate"><span class="pre">standard_name</span></code>. The former contains a longer description of the variable, while the latter comes from a controlled vocabulary in the CF conventions. This allows users of data to understand, in a standard fashion, what a variable represents. If we had missing values, we could also set the <code class="docutils literal notranslate"><span class="pre">missing_value</span></code> attribute to an appropriate value.</p>
<blockquote>
<div><p><strong>NASA Dataset Interoperability Recommendations:</strong></p>
<p>Section 2.2 - Include Basic CF Attributes</p>
<p>Include where applicable: <code class="docutils literal notranslate"><span class="pre">units</span></code>, <code class="docutils literal notranslate"><span class="pre">long_name</span></code>, <code class="docutils literal notranslate"><span class="pre">standard_name</span></code>, <code class="docutils literal notranslate"><span class="pre">valid_min</span></code> / <code class="docutils literal notranslate"><span class="pre">valid_max</span></code>, <code class="docutils literal notranslate"><span class="pre">scale_factor</span></code> / <code class="docutils literal notranslate"><span class="pre">add_offset</span></code> and others.</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temps_var</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;Kelvin&#39;</span>
<span class="n">temps_var</span><span class="o">.</span><span class="n">standard_name</span> <span class="o">=</span> <span class="s1">&#39;air_temperature&#39;</span>
<span class="n">temps_var</span><span class="o">.</span><span class="n">long_name</span> <span class="o">=</span> <span class="s1">&#39;Forecast air temperature&#39;</span>
<span class="n">temps_var</span><span class="o">.</span><span class="n">missing_value</span> <span class="o">=</span> <span class="o">-</span><span class="mi">9999</span>
<span class="n">temps_var</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;netCDF4._netCDF4.Variable&#39;&gt;
float32 Temperature(forecast_time, pressure, y, x)
    units: Kelvin
    standard_name: air_temperature
    long_name: Forecast air temperature
    missing_value: -9999.0
unlimited dimensions: forecast_time
current shape = (13, 7, 67, 101)
filling on, default _FillValue of 9.969209968386869e+36 used
</pre></div>
</div>
</div>
</div>
<p>The resulting CDL (truncated to the variables only) looks like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="n">variables</span><span class="p">:</span>
    <span class="nb">float</span> <span class="n">Temperature</span><span class="p">(</span><span class="n">forecast_time</span><span class="p">,</span> <span class="n">pressure</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="p">;</span>
      <span class="n">Temperature</span><span class="p">:</span><span class="n">units</span> <span class="o">=</span> <span class="s2">&quot;Kelvin&quot;</span> <span class="p">;</span>
      <span class="n">Temperature</span><span class="p">:</span><span class="n">standard_name</span> <span class="o">=</span> <span class="s2">&quot;air_temperature&quot;</span> <span class="p">;</span>
      <span class="n">Temperature</span><span class="p">:</span><span class="n">long_name</span> <span class="o">=</span> <span class="s2">&quot;Forecast air temperature&quot;</span> <span class="p">;</span>
      <span class="n">Temperature</span><span class="p">:</span><span class="n">missing_value</span> <span class="o">=</span> <span class="o">-</span><span class="mf">9999.0</span> <span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="coordinate-variables">
<h3>Coordinate variables<a class="headerlink" href="#coordinate-variables" title="Permalink to this headline"><i class="fas fa-link"></i></a></h3>
<p>To properly orient our data in time and space, we need to go beyond dimensions (which define common sizes and alignment) and include values along these dimensions, which are called “Coordinate Variables”. Generally, these are defined by creating a one dimensional variable with the same name as the respective dimension.</p>
<p>To start, we define variables which define our <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> coordinate values. These variables include <code class="docutils literal notranslate"><span class="pre">standard_name</span></code>s which allow associating them with projections (more on this later) as well as an optional <code class="docutils literal notranslate"><span class="pre">axis</span></code> attribute to make clear what standard direction this coordinate refers to.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_var</span> <span class="o">=</span> <span class="n">nc</span><span class="o">.</span><span class="n">createVariable</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,))</span>
<span class="n">x_var</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">x</span>
<span class="n">x_var</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;km&#39;</span>
<span class="n">x_var</span><span class="o">.</span><span class="n">axis</span> <span class="o">=</span> <span class="s1">&#39;X&#39;</span>  <span class="c1"># Optional</span>
<span class="n">x_var</span><span class="o">.</span><span class="n">standard_name</span> <span class="o">=</span> <span class="s1">&#39;projection_x_coordinate&#39;</span>
<span class="n">x_var</span><span class="o">.</span><span class="n">long_name</span> <span class="o">=</span> <span class="s1">&#39;x-coordinate in projected coordinate system&#39;</span>

<span class="n">y_var</span> <span class="o">=</span> <span class="n">nc</span><span class="o">.</span><span class="n">createVariable</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,))</span>
<span class="n">y_var</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">y</span>
<span class="n">y_var</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;km&#39;</span>
<span class="n">y_var</span><span class="o">.</span><span class="n">axis</span> <span class="o">=</span> <span class="s1">&#39;Y&#39;</span>  <span class="c1"># Optional</span>
<span class="n">y_var</span><span class="o">.</span><span class="n">standard_name</span> <span class="o">=</span> <span class="s1">&#39;projection_y_coordinate&#39;</span>
<span class="n">y_var</span><span class="o">.</span><span class="n">long_name</span> <span class="o">=</span> <span class="s1">&#39;y-coordinate in projected coordinate system&#39;</span>
</pre></div>
</div>
</div>
</div>
<p>We also define a coordinate variable <code class="docutils literal notranslate"><span class="pre">pressure</span></code> to reference our data in the vertical dimension. The <code class="docutils literal notranslate"><span class="pre">standard_name</span></code> of <code class="docutils literal notranslate"><span class="pre">'air_pressure'</span></code> is sufficient to identify this coordinate variable as the vertical axis, but let’s go ahead and specify the <code class="docutils literal notranslate"><span class="pre">axis</span></code> as well. We also specify the attribute <code class="docutils literal notranslate"><span class="pre">positive</span></code> to indicate whether the variable increases when going up or down. In the case of pressure, this is technically optional.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">press_var</span> <span class="o">=</span> <span class="n">nc</span><span class="o">.</span><span class="n">createVariable</span><span class="p">(</span><span class="s1">&#39;pressure&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;pressure&#39;</span><span class="p">,))</span>
<span class="n">press_var</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">press</span>
<span class="n">press_var</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;hPa&#39;</span>
<span class="n">press_var</span><span class="o">.</span><span class="n">axis</span> <span class="o">=</span> <span class="s1">&#39;Z&#39;</span>  <span class="c1"># Optional</span>
<span class="n">press_var</span><span class="o">.</span><span class="n">standard_name</span> <span class="o">=</span> <span class="s1">&#39;air_pressure&#39;</span>
<span class="n">press_var</span><span class="o">.</span><span class="n">positive</span> <span class="o">=</span> <span class="s1">&#39;down&#39;</span>  <span class="c1"># Optional</span>
</pre></div>
</div>
</div>
</div>
<p>Time coordinates must contain a <code class="docutils literal notranslate"><span class="pre">units</span></code> attribute with a string value with a form similar to <code class="docutils literal notranslate"><span class="pre">'seconds</span> <span class="pre">since</span> <span class="pre">2019-01-06</span> <span class="pre">12:00:00.00'</span></code>. ‘seconds’, ‘minutes’, ‘hours’, and ‘days’ are the most commonly used units for time. Due to the variable length of months and years, they are not recommended.</p>
<p>Before we can write data, we need to first convert our list of Python <code class="docutils literal notranslate"><span class="pre">datetime</span></code> instances to numeric values. We can use the <code class="docutils literal notranslate"><span class="pre">date2num</span></code> method from the <code class="docutils literal notranslate"><span class="pre">cftime</span></code> library to make this easy to convert using the unit string as defined above.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">time_units</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;hours since </span><span class="si">{</span><span class="n">times</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s1">%Y-%m-%d 00:00</span><span class="si">}</span><span class="s1">&#39;</span>
<span class="n">time_vals</span> <span class="o">=</span> <span class="n">date2num</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">time_units</span><span class="p">)</span>
<span class="n">time_vals</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34])
</pre></div>
</div>
</div>
</div>
<p>Now we can create the <code class="docutils literal notranslate"><span class="pre">forecast_time</span></code> variable just as we did before for the other coordinate variables:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">time_var</span> <span class="o">=</span> <span class="n">nc</span><span class="o">.</span><span class="n">createVariable</span><span class="p">(</span><span class="s1">&#39;forecast_time&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;forecast_time&#39;</span><span class="p">,))</span>
<span class="n">time_var</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">time_vals</span>
<span class="n">time_var</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="n">time_units</span>
<span class="n">time_var</span><span class="o">.</span><span class="n">axis</span> <span class="o">=</span> <span class="s1">&#39;T&#39;</span>  <span class="c1"># Optional</span>
<span class="n">time_var</span><span class="o">.</span><span class="n">standard_name</span> <span class="o">=</span> <span class="s1">&#39;time&#39;</span>  <span class="c1"># Optional</span>
<span class="n">time_var</span><span class="o">.</span><span class="n">long_name</span> <span class="o">=</span> <span class="s1">&#39;time&#39;</span>
</pre></div>
</div>
</div>
</div>
<p>The CDL representation of the variables now contains much more information:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="n">dimensions</span><span class="p">:</span>
    <span class="n">forecast_time</span> <span class="o">=</span> <span class="n">UNLIMITED</span> <span class="p">(</span><span class="n">currently</span> <span class="mi">13</span><span class="p">)</span> <span class="p">;</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mi">101</span> <span class="p">;</span>
    <span class="n">y</span> <span class="o">=</span> <span class="mi">67</span> <span class="p">;</span>
    <span class="n">pressure</span> <span class="o">=</span> <span class="mi">7</span> <span class="p">;</span>
  <span class="n">variables</span><span class="p">:</span>
    <span class="nb">float</span> <span class="n">x</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="p">;</span>
      <span class="n">x</span><span class="p">:</span><span class="n">units</span> <span class="o">=</span> <span class="s2">&quot;km&quot;</span> <span class="p">;</span>
      <span class="n">x</span><span class="p">:</span><span class="n">axis</span> <span class="o">=</span> <span class="s2">&quot;X&quot;</span> <span class="p">;</span>
      <span class="n">x</span><span class="p">:</span><span class="n">standard_name</span> <span class="o">=</span> <span class="s2">&quot;projection_x_coordinate&quot;</span> <span class="p">;</span>
      <span class="n">x</span><span class="p">:</span><span class="n">long_name</span> <span class="o">=</span> <span class="s2">&quot;x-coordinate in projected coordinate system&quot;</span> <span class="p">;</span>
    <span class="nb">float</span> <span class="n">y</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="p">;</span>
      <span class="n">y</span><span class="p">:</span><span class="n">units</span> <span class="o">=</span> <span class="s2">&quot;km&quot;</span> <span class="p">;</span>
      <span class="n">y</span><span class="p">:</span><span class="n">axis</span> <span class="o">=</span> <span class="s2">&quot;Y&quot;</span> <span class="p">;</span>
      <span class="n">y</span><span class="p">:</span><span class="n">standard_name</span> <span class="o">=</span> <span class="s2">&quot;projection_y_coordinate&quot;</span> <span class="p">;</span>
      <span class="n">y</span><span class="p">:</span><span class="n">long_name</span> <span class="o">=</span> <span class="s2">&quot;y-coordinate in projected coordinate system&quot;</span> <span class="p">;</span>
    <span class="nb">float</span> <span class="n">pressure</span><span class="p">(</span><span class="n">pressure</span><span class="p">)</span> <span class="p">;</span>
      <span class="n">pressure</span><span class="p">:</span><span class="n">units</span> <span class="o">=</span> <span class="s2">&quot;hPa&quot;</span> <span class="p">;</span>
      <span class="n">pressure</span><span class="p">:</span><span class="n">axis</span> <span class="o">=</span> <span class="s2">&quot;Z&quot;</span> <span class="p">;</span>
      <span class="n">pressure</span><span class="p">:</span><span class="n">standard_name</span> <span class="o">=</span> <span class="s2">&quot;air_pressure&quot;</span> <span class="p">;</span>
      <span class="n">pressure</span><span class="p">:</span><span class="n">positive</span> <span class="o">=</span> <span class="s2">&quot;down&quot;</span> <span class="p">;</span>
    <span class="nb">float</span> <span class="n">forecast_time</span><span class="p">(</span><span class="n">forecast_time</span><span class="p">)</span> <span class="p">;</span>
      <span class="n">forecast_time</span><span class="p">:</span><span class="n">units</span> <span class="o">=</span> <span class="s2">&quot;hours since 2019-07-16 00:00&quot;</span> <span class="p">;</span>
      <span class="n">forecast_time</span><span class="p">:</span><span class="n">axis</span> <span class="o">=</span> <span class="s2">&quot;T&quot;</span> <span class="p">;</span>
      <span class="n">forecast_time</span><span class="p">:</span><span class="n">standard_name</span> <span class="o">=</span> <span class="s2">&quot;time&quot;</span> <span class="p">;</span>
      <span class="n">forecast_time</span><span class="p">:</span><span class="n">long_name</span> <span class="o">=</span> <span class="s2">&quot;time&quot;</span> <span class="p">;</span>
    <span class="nb">float</span> <span class="n">Temperature</span><span class="p">(</span><span class="n">forecast_time</span><span class="p">,</span> <span class="n">pressure</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="p">;</span>
      <span class="n">Temperature</span><span class="p">:</span><span class="n">units</span> <span class="o">=</span> <span class="s2">&quot;Kelvin&quot;</span> <span class="p">;</span>
      <span class="n">Temperature</span><span class="p">:</span><span class="n">standard_name</span> <span class="o">=</span> <span class="s2">&quot;air_temperature&quot;</span> <span class="p">;</span>
      <span class="n">Temperature</span><span class="p">:</span><span class="n">long_name</span> <span class="o">=</span> <span class="s2">&quot;Forecast air temperature&quot;</span> <span class="p">;</span>
      <span class="n">Temperature</span><span class="p">:</span><span class="n">missing_value</span> <span class="o">=</span> <span class="o">-</span><span class="mf">9999.0</span> <span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="auxilliary-coordinates">
<h3>Auxilliary Coordinates<a class="headerlink" href="#auxilliary-coordinates" title="Permalink to this headline"><i class="fas fa-link"></i></a></h3>
<p>Our data are still not CF-compliant because they do not contain latitude and longitude information, which is needed to properly locate the data. To solve this, we need to add variables with latitude and longitude. These are called “auxillary coordinate variables”, not because they are extra, but because they are not simple one-dimensional variables.</p>
<p>Below, we first generate longitude and latitude values from our projected coordinates using the <code class="docutils literal notranslate"><span class="pre">pyproj</span></code> library.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">lcc</span> <span class="o">=</span> <span class="n">Proj</span><span class="p">({</span><span class="s1">&#39;proj&#39;</span><span class="p">:</span> <span class="s1">&#39;lcc&#39;</span><span class="p">,</span> <span class="s1">&#39;lon_0&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">105</span><span class="p">,</span> <span class="s1">&#39;lat_0&#39;</span><span class="p">:</span> <span class="mi">40</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mf">6371000.0</span><span class="p">,</span> <span class="s1">&#39;lat_1&#39;</span><span class="p">:</span> <span class="mi">25</span><span class="p">})</span>
<span class="n">lon</span><span class="p">,</span> <span class="n">lat</span> <span class="o">=</span> <span class="n">lcc</span><span class="p">(</span><span class="n">X</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">Y</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now we can create the needed variables. Both are dimensioned on <code class="docutils literal notranslate"><span class="pre">y</span></code> and <code class="docutils literal notranslate"><span class="pre">x</span></code> and are two-dimensional. The longitude variable is identified as actually containing such information by its required units of <code class="docutils literal notranslate"><span class="pre">'degrees_east'</span></code>, as well as the optional <code class="docutils literal notranslate"><span class="pre">'longitude'</span></code> <code class="docutils literal notranslate"><span class="pre">standard_name</span></code> attribute. The case is the same for latitude, except the units are <code class="docutils literal notranslate"><span class="pre">'degrees_north'</span></code> and the <code class="docutils literal notranslate"><span class="pre">standard_name</span></code> is <code class="docutils literal notranslate"><span class="pre">'latitude'</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lon_var</span> <span class="o">=</span> <span class="n">nc</span><span class="o">.</span><span class="n">createVariable</span><span class="p">(</span><span class="s1">&#39;lon&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">))</span>
<span class="n">lon_var</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">lon</span>
<span class="n">lon_var</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;degrees_east&#39;</span>
<span class="n">lon_var</span><span class="o">.</span><span class="n">standard_name</span> <span class="o">=</span> <span class="s1">&#39;longitude&#39;</span>  <span class="c1"># Optional</span>
<span class="n">lon_var</span><span class="o">.</span><span class="n">long_name</span> <span class="o">=</span> <span class="s1">&#39;longitude&#39;</span>

<span class="n">lat_var</span> <span class="o">=</span> <span class="n">nc</span><span class="o">.</span><span class="n">createVariable</span><span class="p">(</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">))</span>
<span class="n">lat_var</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">lat</span>
<span class="n">lat_var</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;degrees_north&#39;</span>
<span class="n">lat_var</span><span class="o">.</span><span class="n">standard_name</span> <span class="o">=</span> <span class="s1">&#39;latitude&#39;</span>  <span class="c1"># Optional</span>
<span class="n">lat_var</span><span class="o">.</span><span class="n">long_name</span> <span class="o">=</span> <span class="s1">&#39;latitude&#39;</span>
</pre></div>
</div>
</div>
</div>
<p>With the variables created, we identify these variables as containing coordinates for the <code class="docutils literal notranslate"><span class="pre">Temperature</span></code> variable by setting the <code class="docutils literal notranslate"><span class="pre">coordinates</span></code> value to a space-separated list of the names of the auxilliary coordinate variables:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temps_var</span><span class="o">.</span><span class="n">coordinates</span> <span class="o">=</span> <span class="s1">&#39;lon lat&#39;</span>
</pre></div>
</div>
</div>
</div>
<p>This yields the following CDL:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="n">double</span> <span class="n">lon</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">);</span>
    <span class="n">lon</span><span class="p">:</span><span class="n">units</span> <span class="o">=</span> <span class="s2">&quot;degrees_east&quot;</span><span class="p">;</span>
    <span class="n">lon</span><span class="p">:</span><span class="n">long_name</span> <span class="o">=</span> <span class="s2">&quot;longitude coordinate&quot;</span><span class="p">;</span>
    <span class="n">lon</span><span class="p">:</span><span class="n">standard_name</span> <span class="o">=</span> <span class="s2">&quot;longitude&quot;</span><span class="p">;</span>
  <span class="n">double</span> <span class="n">lat</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">);</span>
    <span class="n">lat</span><span class="p">:</span><span class="n">units</span> <span class="o">=</span> <span class="s2">&quot;degrees_north&quot;</span><span class="p">;</span>
    <span class="n">lat</span><span class="p">:</span><span class="n">long_name</span> <span class="o">=</span> <span class="s2">&quot;latitude coordinate&quot;</span><span class="p">;</span>
    <span class="n">lat</span><span class="p">:</span><span class="n">standard_name</span> <span class="o">=</span> <span class="s2">&quot;latitude&quot;</span><span class="p">;</span>
  <span class="nb">float</span> <span class="n">Temperature</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">);</span>
    <span class="n">Temperature</span><span class="p">:</span><span class="n">units</span> <span class="o">=</span> <span class="s2">&quot;Kelvin&quot;</span> <span class="p">;</span>
    <span class="n">Temperature</span><span class="p">:</span><span class="n">standard_name</span> <span class="o">=</span> <span class="s2">&quot;air_temperature&quot;</span> <span class="p">;</span>
    <span class="n">Temperature</span><span class="p">:</span><span class="n">long_name</span> <span class="o">=</span> <span class="s2">&quot;Forecast air temperature&quot;</span> <span class="p">;</span>
    <span class="n">Temperature</span><span class="p">:</span><span class="n">missing_value</span> <span class="o">=</span> <span class="o">-</span><span class="mf">9999.0</span> <span class="p">;</span>
    <span class="n">Temperature</span><span class="p">:</span><span class="n">coordinates</span> <span class="o">=</span> <span class="s2">&quot;lon lat&quot;</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="coordinate-system-information">
<h3>Coordinate System Information<a class="headerlink" href="#coordinate-system-information" title="Permalink to this headline"><i class="fas fa-link"></i></a></h3>
<p>With our data specified on a Lambert conformal projected grid, it would be good to include this information in our metadata. We can do this using a “grid mapping” variable. This uses a dummy scalar variable as a namespace for holding all of the required information. Relevant variables then reference the dummy variable with their <code class="docutils literal notranslate"><span class="pre">grid_mapping</span></code> attribute.</p>
<p>Below we create a variable and set it up for a Lambert conformal conic projection on a spherical earth. The <code class="docutils literal notranslate"><span class="pre">grid_mapping_name</span></code> attribute describes which of the CF-supported grid mappings we are specifying. The names of additional attributes vary between the mappings.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">proj_var</span> <span class="o">=</span> <span class="n">nc</span><span class="o">.</span><span class="n">createVariable</span><span class="p">(</span><span class="s1">&#39;lambert_projection&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">,</span> <span class="p">())</span>
<span class="n">proj_var</span><span class="o">.</span><span class="n">grid_mapping_name</span> <span class="o">=</span> <span class="s1">&#39;lambert_conformal_conic&#39;</span>
<span class="n">proj_var</span><span class="o">.</span><span class="n">standard_parallel</span> <span class="o">=</span> <span class="mf">25.0</span>
<span class="n">proj_var</span><span class="o">.</span><span class="n">latitude_of_projection_origin</span> <span class="o">=</span> <span class="mf">40.0</span>
<span class="n">proj_var</span><span class="o">.</span><span class="n">longitude_of_central_meridian</span> <span class="o">=</span> <span class="o">-</span><span class="mf">105.0</span>
<span class="n">proj_var</span><span class="o">.</span><span class="n">semi_major_axis</span> <span class="o">=</span> <span class="mf">6371000.0</span>
<span class="n">proj_var</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;netCDF4._netCDF4.Variable&#39;&gt;
int32 lambert_projection()
    grid_mapping_name: lambert_conformal_conic
    standard_parallel: 25.0
    latitude_of_projection_origin: 40.0
    longitude_of_central_meridian: -105.0
    semi_major_axis: 6371000.0
unlimited dimensions: 
current shape = ()
filling on, default _FillValue of -2147483647 used
</pre></div>
</div>
</div>
</div>
<p>Now that we created the variable, all that’s left is to set the <code class="docutils literal notranslate"><span class="pre">grid_mapping</span></code> attribute on our <code class="docutils literal notranslate"><span class="pre">Temperature</span></code> variable to the name of our dummy variable:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temps_var</span><span class="o">.</span><span class="n">grid_mapping</span> <span class="o">=</span> <span class="s1">&#39;lambert_projection&#39;</span>  <span class="c1"># or proj_var.name</span>
</pre></div>
</div>
</div>
</div>
<p>This yields the CDL:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="n">variables</span><span class="p">:</span>
    <span class="nb">int</span> <span class="n">lambert_projection</span> <span class="p">;</span>
      <span class="n">lambert_projection</span><span class="p">:</span><span class="n">grid_mapping_name</span> <span class="o">=</span> <span class="s2">&quot;lambert_conformal_conic ;</span>
      <span class="n">lambert_projection</span><span class="p">:</span><span class="n">standard_parallel</span> <span class="o">=</span> <span class="mf">25.0</span> <span class="p">;</span>
      <span class="n">lambert_projection</span><span class="p">:</span><span class="n">latitude_of_projection_origin</span> <span class="o">=</span> <span class="mf">40.0</span> <span class="p">;</span>
      <span class="n">lambert_projection</span><span class="p">:</span><span class="n">longitude_of_central_meridian</span> <span class="o">=</span> <span class="o">-</span><span class="mf">105.0</span> <span class="p">;</span>
      <span class="n">lambert_projection</span><span class="p">:</span><span class="n">semi_major_axis</span> <span class="o">=</span> <span class="mf">6371000.0</span> <span class="p">;</span>
    <span class="nb">float</span> <span class="n">Temperature</span><span class="p">(</span><span class="n">forecast_time</span><span class="p">,</span> <span class="n">pressure</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="p">;</span>
      <span class="n">Temperature</span><span class="p">:</span><span class="n">units</span> <span class="o">=</span> <span class="s2">&quot;Kelvin&quot;</span> <span class="p">;</span>
      <span class="n">Temperature</span><span class="p">:</span><span class="n">standard_name</span> <span class="o">=</span> <span class="s2">&quot;air_temperature&quot;</span> <span class="p">;</span>
      <span class="n">Temperature</span><span class="p">:</span><span class="n">long_name</span> <span class="o">=</span> <span class="s2">&quot;Forecast air temperature&quot;</span> <span class="p">;</span>
      <span class="n">Temperature</span><span class="p">:</span><span class="n">missing_value</span> <span class="o">=</span> <span class="o">-</span><span class="mf">9999.0</span> <span class="p">;</span>
      <span class="n">Temperature</span><span class="p">:</span><span class="n">coordinates</span> <span class="o">=</span> <span class="s2">&quot;lon lat&quot;</span> <span class="p">;</span>
      <span class="n">Temperature</span><span class="p">:</span><span class="n">grid_mapping</span> <span class="o">=</span> <span class="s2">&quot;lambert_projection&quot;</span> <span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="cell-bounds">
<h3>Cell Bounds<a class="headerlink" href="#cell-bounds" title="Permalink to this headline"><i class="fas fa-link"></i></a></h3>
<blockquote>
<div><p><strong>NASA Dataset Interoperability Recommendations:</strong></p>
<p>Section 2.3 - Use CF “bounds” attributes</p>
<p>CF conventions state: “When gridded data does not represent the point values of a field but instead represents some characteristic of the field within cells of finite ‘volume,’ a complete description of the variable should include metadata that describes the domain or extent of each cell, and the characteristic of the field that the cell values represent.”</p>
</div></blockquote>
<p>For example, if a rain guage is read every 3 hours but only dumped every six hours, it might look like this</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">netcdf</span> <span class="n">precip_bucket_bounds</span> <span class="p">{</span>
  <span class="n">dimensions</span><span class="p">:</span>
      <span class="n">lat</span> <span class="o">=</span> <span class="mi">12</span> <span class="p">;</span>
      <span class="n">lon</span> <span class="o">=</span> <span class="mi">19</span> <span class="p">;</span>
      <span class="n">time</span> <span class="o">=</span> <span class="mi">8</span> <span class="p">;</span>
      <span class="n">tbv</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
  <span class="n">variables</span><span class="p">:</span>
      <span class="nb">float</span> <span class="n">lat</span><span class="p">(</span><span class="n">lat</span><span class="p">)</span> <span class="p">;</span>
      <span class="nb">float</span> <span class="n">lon</span><span class="p">(</span><span class="n">lon</span><span class="p">)</span> <span class="p">;</span>
      <span class="nb">float</span> <span class="n">time</span><span class="p">(</span><span class="n">time</span><span class="p">)</span> <span class="p">;</span>
        <span class="n">time</span><span class="p">:</span><span class="n">units</span> <span class="o">=</span> <span class="s2">&quot;hours since 2019-07-12 00:00:00.00&quot;</span><span class="p">;</span>
        <span class="n">time</span><span class="p">:</span><span class="n">bounds</span> <span class="o">=</span> <span class="s2">&quot;time_bounds&quot;</span> <span class="p">;</span>
      <span class="nb">float</span> <span class="n">time_bounds</span><span class="p">(</span><span class="n">time</span><span class="p">,</span><span class="n">tbv</span><span class="p">)</span>
      <span class="nb">float</span> <span class="n">precip</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">)</span> <span class="p">;</span>
        <span class="n">precip</span><span class="p">:</span><span class="n">units</span> <span class="o">=</span> <span class="s2">&quot;inches&quot;</span> <span class="p">;</span>
  <span class="n">data</span><span class="p">:</span>
    <span class="n">time</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">24</span><span class="p">;</span>
    <span class="n">time_bounds</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">24</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>So the time coordinate looks like</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">|---</span><span class="n">X</span>
<span class="o">|-------</span><span class="n">X</span>
        <span class="o">|---</span><span class="n">X</span>
        <span class="o">|-------</span><span class="n">X</span>
                <span class="o">|---</span><span class="n">X</span>
                <span class="o">|-------</span><span class="n">X</span>
                        <span class="o">|---</span><span class="n">X</span>
                        <span class="o">|-------</span><span class="n">X</span>
<span class="mi">0</span>   <span class="mi">3</span>   <span class="mi">6</span>   <span class="mi">9</span>  <span class="mi">12</span>  <span class="mi">15</span>  <span class="mi">18</span>  <span class="mi">21</span>  <span class="mi">24</span>
</pre></div>
</div>
<p><a name="obs"></a></p>
</div>
</div>
<div class="section" id="observational-data">
<h2>Observational Data<a class="headerlink" href="#observational-data" title="Permalink to this headline"><i class="fas fa-link"></i></a></h2>
<p>So far we’ve focused on how to handle storing data that are arranged in a grid. What about in-situ data, often termed “observational” data? CF describes this as <em>Conventions for Discrete Sampling Geometeries (DSG)</em>.</p>
<p>For data that are regularly sampled (e.g., from a vertical profiler site), this is straightforward. First, let’s define some sample profile data for three hypothetical profilers located at Boulder, Norman, and Albany. We’ll assume that the profiler reports data every 10m, from 10 m up to (but not including) 1000 m.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lons</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">97.1</span><span class="p">,</span> <span class="o">-</span><span class="mi">105</span><span class="p">,</span> <span class="o">-</span><span class="mf">73.8</span><span class="p">])</span>
<span class="n">lats</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">35.25</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mf">42.75</span><span class="p">])</span>
<span class="n">heights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">temps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">lats</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">heights</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
<span class="n">stids</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;KBOU&#39;</span><span class="p">,</span> <span class="s1">&#39;KOUN&#39;</span><span class="p">,</span> <span class="s1">&#39;KALB&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="creation-and-basic-setup">
<h3>Creation and basic setup<a class="headerlink" href="#creation-and-basic-setup" title="Permalink to this headline"><i class="fas fa-link"></i></a></h3>
<p>First we create a new file and define some dimensions. Since this is profile data, heights will be one dimension. We use station as our other dimension. We also set the global <code class="docutils literal notranslate"><span class="pre">featureType</span></code> attribute to <code class="docutils literal notranslate"><span class="pre">'profile'</span></code> to indicate that this file holds “an ordered set of data points along a vertical line at a fixed horizontal position and fixed time”. We also add a dimension to assist in storing our string station ids.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nc</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">nc</span> <span class="o">=</span> <span class="n">Dataset</span><span class="p">(</span><span class="s1">&#39;obs_data.nc&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;NETCDF4_CLASSIC&#39;</span><span class="p">,</span> <span class="n">diskless</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">nc</span><span class="o">.</span><span class="n">createDimension</span><span class="p">(</span><span class="s1">&#39;station&#39;</span><span class="p">,</span> <span class="n">lats</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
<span class="n">nc</span><span class="o">.</span><span class="n">createDimension</span><span class="p">(</span><span class="s1">&#39;heights&#39;</span><span class="p">,</span> <span class="n">heights</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
<span class="n">nc</span><span class="o">.</span><span class="n">createDimension</span><span class="p">(</span><span class="s1">&#39;str_len&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">nc</span><span class="o">.</span><span class="n">Conventions</span> <span class="o">=</span> <span class="s1">&#39;CF-1.7&#39;</span>
<span class="n">nc</span><span class="o">.</span><span class="n">featureType</span> <span class="o">=</span> <span class="s1">&#39;profile&#39;</span>
<span class="n">nc</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;netCDF4._netCDF4.Dataset&#39;&gt;
root group (NETCDF4_CLASSIC data model, file format HDF5):
    Conventions: CF-1.7
    featureType: profile
    dimensions(sizes): station(3), heights(10), str_len(4)
    variables(dimensions): 
    groups: 
</pre></div>
</div>
</div>
</div>
<p>Which gives this CDL:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">netcdf</span> <span class="n">obs_data</span> <span class="p">{</span>
  <span class="n">dimensions</span><span class="p">:</span>
    <span class="n">station</span> <span class="o">=</span> <span class="mi">3</span> <span class="p">;</span>
    <span class="n">heights</span> <span class="o">=</span> <span class="mi">10</span> <span class="p">;</span>
    <span class="n">str_len</span> <span class="o">=</span> <span class="mi">4</span> <span class="p">;</span>
  <span class="n">attributes</span><span class="p">:</span>
    <span class="p">:</span><span class="n">Conventions</span> <span class="o">=</span> <span class="s2">&quot;CF-1.7&quot;</span> <span class="p">;</span>
    <span class="p">:</span><span class="n">featureType</span> <span class="o">=</span> <span class="s2">&quot;profile&quot;</span> <span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>We can create our coordinates with:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lon_var</span> <span class="o">=</span> <span class="n">nc</span><span class="o">.</span><span class="n">createVariable</span><span class="p">(</span><span class="s1">&#39;lon&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;station&#39;</span><span class="p">,))</span>
<span class="n">lon_var</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;degrees_east&#39;</span>
<span class="n">lon_var</span><span class="o">.</span><span class="n">standard_name</span> <span class="o">=</span> <span class="s1">&#39;longitude&#39;</span>

<span class="n">lat_var</span> <span class="o">=</span> <span class="n">nc</span><span class="o">.</span><span class="n">createVariable</span><span class="p">(</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;station&#39;</span><span class="p">,))</span>
<span class="n">lat_var</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;degrees_north&#39;</span>
<span class="n">lat_var</span><span class="o">.</span><span class="n">standard_name</span> <span class="o">=</span> <span class="s1">&#39;latitude&#39;</span>
</pre></div>
</div>
</div>
</div>
<p>The standard refers to these as “instance variables” because each one refers to an instance of a feature. From here we can create our <code class="docutils literal notranslate"><span class="pre">height</span></code> coordinate variable:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">heights_var</span> <span class="o">=</span> <span class="n">nc</span><span class="o">.</span><span class="n">createVariable</span><span class="p">(</span><span class="s1">&#39;heights&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;heights&#39;</span><span class="p">,))</span>
<span class="n">heights_var</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;meters&#39;</span>
<span class="n">heights_var</span><span class="o">.</span><span class="n">standard_name</span> <span class="o">=</span> <span class="s1">&#39;altitude&#39;</span>
<span class="n">heights_var</span><span class="o">.</span><span class="n">positive</span> <span class="o">=</span> <span class="s1">&#39;up&#39;</span>
<span class="n">heights_var</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">heights</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="station-ids">
<h3>Station IDs<a class="headerlink" href="#station-ids" title="Permalink to this headline"><i class="fas fa-link"></i></a></h3>
<p>Now we can also write our station IDs to a variable. This is a 2D variable, but one of the dimensions is simply there to facilitate treating strings as character arrays. We also assign this an attribute <code class="docutils literal notranslate"><span class="pre">cf_role</span></code> with a value of <code class="docutils literal notranslate"><span class="pre">'profile_id'</span></code> to facilitate software to identify individual profiles:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stid_var</span> <span class="o">=</span> <span class="n">nc</span><span class="o">.</span><span class="n">createVariable</span><span class="p">(</span><span class="s1">&#39;stid&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;station&#39;</span><span class="p">,</span> <span class="s1">&#39;str_len&#39;</span><span class="p">))</span>
<span class="n">stid_var</span><span class="o">.</span><span class="n">cf_role</span> <span class="o">=</span> <span class="s1">&#39;profile_id&#39;</span>
<span class="n">stid_var</span><span class="o">.</span><span class="n">long_name</span> <span class="o">=</span> <span class="s1">&#39;Station identifier&#39;</span>
<span class="n">stid_var</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">stids</span>
</pre></div>
</div>
</div>
</div>
<p>Now our CDL looks like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">netcdf</span> <span class="n">obs_data</span> <span class="p">{</span>
  <span class="n">dimensions</span><span class="p">:</span>
    <span class="n">station</span> <span class="o">=</span> <span class="mi">3</span> <span class="p">;</span>
    <span class="n">heights</span> <span class="o">=</span> <span class="mi">10</span> <span class="p">;</span>
    <span class="n">str_len</span> <span class="o">=</span> <span class="mi">4</span> <span class="p">;</span>
  <span class="n">variables</span><span class="p">:</span>
    <span class="n">double</span> <span class="n">lon</span><span class="p">(</span><span class="n">station</span><span class="p">)</span> <span class="p">;</span>
      <span class="n">lon</span><span class="p">:</span><span class="n">units</span> <span class="o">=</span> <span class="s2">&quot;degrees_east&quot;</span> <span class="p">;</span>
      <span class="n">lon</span><span class="p">:</span><span class="n">standard_name</span> <span class="o">=</span> <span class="s2">&quot;longitude&quot;</span> <span class="p">;</span>
    <span class="n">double</span> <span class="n">lat</span><span class="p">(</span><span class="n">station</span><span class="p">)</span> <span class="p">;</span>
      <span class="n">lat</span><span class="p">:</span><span class="n">units</span> <span class="o">=</span> <span class="s2">&quot;degrees_north&quot;</span> <span class="p">;</span>
      <span class="n">lat</span><span class="p">:</span><span class="n">standard_name</span> <span class="o">=</span> <span class="s2">&quot;latitude&quot;</span> <span class="p">;</span>
    <span class="nb">float</span> <span class="n">heights</span><span class="p">(</span><span class="n">heights</span><span class="p">)</span> <span class="p">;</span>
      <span class="n">heights</span><span class="p">:</span><span class="n">units</span> <span class="o">=</span> <span class="s2">&quot;meters&quot;</span> <span class="p">;</span>
      <span class="n">heights</span><span class="p">:</span><span class="n">standard_name</span> <span class="o">=</span> <span class="s2">&quot;altitude&quot;</span><span class="p">;</span>
      <span class="n">heights</span><span class="p">:</span><span class="n">positive</span> <span class="o">=</span> <span class="s2">&quot;up&quot;</span> <span class="p">;</span>
    <span class="n">char</span> <span class="n">stid</span><span class="p">(</span><span class="n">station</span><span class="p">,</span> <span class="n">str_len</span><span class="p">)</span> <span class="p">;</span>
      <span class="n">stid</span><span class="p">:</span><span class="n">cf_role</span> <span class="o">=</span> <span class="s2">&quot;profile_id&quot;</span> <span class="p">;</span>
      <span class="n">stid</span><span class="p">:</span><span class="n">long_name</span> <span class="o">=</span> <span class="s2">&quot;Station identifier&quot;</span> <span class="p">;</span>
  <span class="n">attributes</span><span class="p">:</span>
    <span class="p">:</span><span class="n">Conventions</span> <span class="o">=</span> <span class="s2">&quot;CF-1.7&quot;</span> <span class="p">;</span>
    <span class="p">:</span><span class="n">featureType</span> <span class="o">=</span> <span class="s2">&quot;profile&quot;</span> <span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="writing-the-field">
<h3>Writing the field<a class="headerlink" href="#writing-the-field" title="Permalink to this headline"><i class="fas fa-link"></i></a></h3>
<p>Now all that’s left is to write our profile data, which looks fairly standard. We also add a scalar variable for the time at which these profiles were captured:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">time_var</span> <span class="o">=</span> <span class="n">nc</span><span class="o">.</span><span class="n">createVariable</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="p">())</span>
<span class="n">time_var</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;minutes since 2019-07-16 17:00&#39;</span>
<span class="n">time_var</span><span class="o">.</span><span class="n">standard_name</span> <span class="o">=</span> <span class="s1">&#39;time&#39;</span>
<span class="n">time_var</span><span class="p">[:]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">5.0</span><span class="p">]</span>

<span class="n">temp_var</span> <span class="o">=</span> <span class="n">nc</span><span class="o">.</span><span class="n">createVariable</span><span class="p">(</span><span class="s1">&#39;temperature&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;station&#39;</span><span class="p">,</span> <span class="s1">&#39;heights&#39;</span><span class="p">))</span>
<span class="n">temp_var</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;celsius&#39;</span>
<span class="n">temp_var</span><span class="o">.</span><span class="n">standard_name</span> <span class="o">=</span> <span class="s1">&#39;air_temperature&#39;</span>
<span class="n">temp_var</span><span class="o">.</span><span class="n">coordinates</span> <span class="o">=</span> <span class="s1">&#39;lon lat heights time&#39;</span>
</pre></div>
</div>
</div>
</div>
<p>Note the use of the <code class="docutils literal notranslate"><span class="pre">coordinates</span></code> attribute to store the names of the auxilliary coordinate variables since they’re all dimensioned on <code class="docutils literal notranslate"><span class="pre">station</span></code> and not proper coordinate variables. This yields the CDL for the variables:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="n">variables</span><span class="p">:</span>
    <span class="n">double</span> <span class="n">lon</span><span class="p">(</span><span class="n">station</span><span class="p">)</span> <span class="p">;</span>
      <span class="n">lon</span><span class="p">:</span><span class="n">units</span> <span class="o">=</span> <span class="s2">&quot;degrees_east&quot;</span> <span class="p">;</span>
      <span class="n">lon</span><span class="p">:</span><span class="n">standard_name</span> <span class="o">=</span> <span class="s2">&quot;longitude&quot;</span> <span class="p">;</span>
    <span class="n">double</span> <span class="n">lat</span><span class="p">(</span><span class="n">station</span><span class="p">)</span> <span class="p">;</span>
      <span class="n">lat</span><span class="p">:</span><span class="n">units</span> <span class="o">=</span> <span class="s2">&quot;degrees_north&quot;</span> <span class="p">;</span>
      <span class="n">lat</span><span class="p">:</span><span class="n">standard_name</span> <span class="o">=</span> <span class="s2">&quot;latitude&quot;</span> <span class="p">;</span>
    <span class="nb">float</span> <span class="n">heights</span><span class="p">(</span><span class="n">heights</span><span class="p">)</span> <span class="p">;</span>
      <span class="n">heights</span><span class="p">:</span><span class="n">units</span> <span class="o">=</span> <span class="s2">&quot;meters&quot;</span> <span class="p">;</span>
      <span class="n">heights</span><span class="p">:</span><span class="n">standard_name</span> <span class="o">=</span> <span class="s2">&quot;altitude&quot;</span><span class="p">;</span>
      <span class="n">heights</span><span class="p">:</span><span class="n">positive</span> <span class="o">=</span> <span class="s2">&quot;up&quot;</span> <span class="p">;</span>
    <span class="n">char</span> <span class="n">stid</span><span class="p">(</span><span class="n">station</span><span class="p">,</span> <span class="n">str_len</span><span class="p">)</span> <span class="p">;</span>
      <span class="n">stid</span><span class="p">:</span><span class="n">cf_role</span> <span class="o">=</span> <span class="s2">&quot;profile_id&quot;</span> <span class="p">;</span>
      <span class="n">stid</span><span class="p">:</span><span class="n">long_name</span> <span class="o">=</span> <span class="s2">&quot;Station identifier&quot;</span> <span class="p">;</span>
    <span class="nb">float</span> <span class="n">time</span> <span class="p">;</span>
      <span class="n">time</span><span class="p">:</span><span class="n">units</span> <span class="o">=</span> <span class="s2">&quot;minutes since 2019-07-16 17:00&quot;</span> <span class="p">;</span>
      <span class="n">time</span><span class="p">:</span><span class="n">standard_name</span> <span class="o">=</span> <span class="s2">&quot;time&quot;</span> <span class="p">;</span>
    <span class="nb">float</span> <span class="n">temperature</span><span class="p">(</span><span class="n">station</span><span class="p">,</span> <span class="n">heights</span><span class="p">)</span> <span class="p">;</span>
      <span class="n">temperature</span><span class="p">:</span><span class="n">units</span> <span class="o">=</span> <span class="s2">&quot;celsius&quot;</span> <span class="p">;</span>
      <span class="n">temperature</span><span class="p">:</span><span class="n">standard_name</span> <span class="o">=</span> <span class="s2">&quot;air_temperature&quot;</span> <span class="p">;</span>
      <span class="n">temperature</span><span class="p">:</span><span class="n">coordinates</span> <span class="o">=</span> <span class="s2">&quot;lon lat heights time&quot;</span> <span class="p">;</span>
</pre></div>
</div>
<p>These standards for storing DSG extend to time series, trajectories, and combinations of them. They also can extend for differing amounts of data  per feature using ragged arrays. For more information see the <a class="reference external" href="http://cfconventions.org/Data/cf-conventions/cf-conventions-1.7/cf-conventions.html#discrete-sampling-geometries">main document</a> or the <a class="reference external" href="http://cfconventions.org/Data/cf-conventions/cf-conventions-1.7/cf-conventions.html#appendix-examples-discrete-geometries">annotated DSG examples</a>.</p>
</div>
</div>
<hr class="docutils" />
<div class="section" id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Permalink to this headline"><i class="fas fa-link"></i></a></h2>
<p>We have discussed and created examples of <strong>netCDF</strong> <code class="docutils literal notranslate"><span class="pre">Dataset</span></code>s, both gridded and in-situ, that follow the Climate and Forecast (<strong>CF</strong>) Conventions. These <code class="docutils literal notranslate"><span class="pre">Dataset</span></code>s are <em>self-describing</em>, in that their attributes, or <em>metadata</em>, are included. Other libraries in the Python scientific software ecosystem, such as <code class="docutils literal notranslate"><span class="pre">xarray</span></code> and <code class="docutils literal notranslate"><span class="pre">MetPy</span></code> can thus easily read in (and write to) and analyze these <code class="docutils literal notranslate"><span class="pre">Dataset</span></code>s.</p>
<div class="section" id="whats-next">
<h3>What’s Next?<a class="headerlink" href="#whats-next" title="Permalink to this headline"><i class="fas fa-link"></i></a></h3>
<p>In subsequent notebooks, we will work with netCDF <code class="docutils literal notranslate"><span class="pre">Dataset</span></code>s culled from “real-life” model and in-situ sources.</p>
<p><a name="references"></a></p>
</div>
</div>
<div class="section" id="resources-and-references">
<h2>Resources and References<a class="headerlink" href="#resources-and-references" title="Permalink to this headline"><i class="fas fa-link"></i></a></h2>
<ul class="simple">
<li><p><a class="reference external" href="http://cfconventions.org/Data/cf-conventions/cf-conventions-1.7/cf-conventions.html">CF Conventions doc (1.7)</a></p></li>
<li><p><a class="reference external" href="http://cfconventions.org/Data/cf-documents/overview/viewgraphs.pdf">Jonathan Gregory’s old CF presentation</a></p></li>
<li><p><a class="reference external" href="https://earthdata.nasa.gov/user-resources/standards-and-references/dataset-interoperability-recommendations-for-earth-science">NASA ESDS “Dataset Interoperability Recommendations for Earth Science”</a></p></li>
<li><p><a class="reference external" href="https://ncas-cms.github.io/cfdm/tutorial.html">CF Data Model (cfdm) python package tutorial</a></p></li>
<li><p><a class="reference external" href="https://github.com/twhiteaker/CFGeom">Tim Whiteaker’s cfgeom python package (GitHub repo)</a> and <a class="reference external" href="https://twhiteaker.github.io/CFGeom/tutorial.html">(tutorial)</a></p></li>
<li><p><a class="reference external" href="https://unidata.github.io/netcdf4-python/">netCDF4 Documentation</a></p></li>
</ul>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./core/data-formats"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="../data-formats.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Data Formats</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../xarray.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Xarray</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </div>
          </div>
        </main>

      </div>
    </div>
  
  <script src="../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

<footer class="footer">
  <div class="container-fluid m-0 p-0">
  
    <div class="footer-item">
    
  <div class="container-fluid footer-logos">
    <div class="container-xl">
      <div class="row d-flex flex-wrap align-items-center">
        <div class="d-flex col-lg-3 col-md-4 col-sm-6 p-2 mx-auto">
          <img alt="NCAR" src="../../_images/NCAR-contemp-logo-blue.svg" style="width: 100%">
        </div>
        <div class="d-flex col-lg-3 col-md-4 col-sm-6 p-2 mx-auto">
          <img alt="Unidata" src="../../_images/Unidata_logo_horizontal_1200x300.svg" style="width: 100%">
        </div>
        <div class="d-flex col-lg-3 col-md-4 col-sm-6 p-2 mx-auto">
          <img alt="UAlbany" src="../../_images/UAlbany-A2-logo-purple-gold.svg" style="width: 100%">
        </div>
      </div>
    </div>
  </div>
    </div>
  
    <div class="footer-item">
    <div class="container-fluid footer-menu pt-4">
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-9 col-sm-4 col-md-4 col-lg-3 footer-menu-col">
        <h1>About</h1>
        <ul class="list-unstyled">
          <li>
            <a href="https://projectpythia.org/about.html"
              >About Project Pythia</a
            >
          </li>
          <li>
            <a
              href="https://foundations.projectpythia.org/preamble/how-to-use.html"
              >How to use Pythia Foundations</a
            >
          </li>
          <li>
            <a href="https://projectpythia.org/#the-project-pythia-team"
              >The Project Team</a
            >
          </li>
        </ul>
      </div>
      <div class="col-9 col-sm-4 col-md-4 col-lg-3 footer-menu-col">
        <h1>Give Feedback</h1>
        <ul class="list-unstyled">
          <li>
            <a href="mailto:projectpythia@ucar.edu">Email us!</a>
          </li>
          <li>
            <a
              href="https://github.com/ProjectPythia/projectpythia.github.io/discussions"
              >Project Pythia Discussions</a
            >
          </li>
          <li>
            <a
              href="https://github.com/ProjectPythia/pythia-foundations/discussions"
              >Pythia Foundations Discussions</a
            >
          </li>
        </ul>
      </div>
      <div class="col-9 col-sm-4 col-md-4 col-lg-3 footer-menu-col">
        <h1>Contribute</h1>
        <ul class="list-unstyled">
          <li>
            <a href="https://projectpythia.org/contributing.html"
              >How to contribute to Project Pythia</a
            >
          </li>
          <li>
            <a
              href="https://foundations.projectpythia.org/appendix/how-to-contribute.html"
              >How to contribute to Pythia Foundations</a
            >
          </li>
          <li>
            <a href="https://projectpythia.org/code_of_conduct.html"
              >Our code of conduct</a
            >
          </li>
          <li>
            <a href="https://projectpythia.org/#weekly-working-group-meetings"
              >Join our weekly meetings</a
            >
          </li>
          <li>
            <a href="https://github.com/ProjectPythia"
              >Join us on GitHub</a
            >
          </li>
        </ul>
      </div>
    </div>
  </div>
</div>
    </div>
  
    <div class="footer-item">
      <div class="container-fluid footer-info">
    <div class="container-xl">
      <div class="d-flex justify-content-center">
        <p class="py-1 m-0">
            &copy;&nbsp;2022.
        
          By the <a href="https://projectpythia.org/">Project Pythia</a> Community.
        
          Last updated on 7 February 2023.
        </p>
      </div>
    </div>
  </div>
    </div>
  
    <div class="footer-item">
    <div class="container-fluid footer-extra">
  <div class="container">
    <div class="row">
      <p class="m-0">
        <img
          src="../../_static/footer-logo-nsf.png"
          style="float: left; width: 60px; height: 60px; margin-right: 1rem"
        />
        This material is based upon work supported by the National Science
        Foundation under Grant Nos. 2026863 and 2026899. Any opinions, findings,
        and conclusions or recommendations expressed in this material are those
        of the author(s) and do not necessarily reflect the views of the
        National Science Foundation.
      </p>
    </div>
  </div>
</div>
    </div>
  
  </div>
</footer>
  </body>
</html>