{"version":3,"kind":"Notebook","sha256":"7588d4298ff042bbbba32eeed163feba4d21f901fef7e73984a8fe4cc169dfba","slug":"core.xarray.enso-xarray","location":"/core/xarray/enso-xarray.ipynb","dependencies":[],"frontmatter":{"title":"Calculating ENSO with Xarray","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"authors":[{"id":"Project Pythia Community","name":"Project Pythia Community"}],"doi":"https://doi.org/10.5281/zenodo.7884571","open_access":true,"license":{"content":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true},"code":{"id":"Apache-2.0","url":"https://opensource.org/licenses/Apache-2.0","name":"Apache License 2.0","free":true,"osi":true}},"github":"https://github.com/projectpythia/pythia-foundations","copyright":"2024","affiliations":[{"id":"UAlbany","name":"University at Albany (SUNY)","department":"Atmospheric and Environmental Sciences","url":"https://www.albany.edu/daes"},{"id":"CISL","name":"NSF National Center for Atmospheric Research","department":"Computational and Information Systems Lab","url":"https://www.cisl.ucar.edu"},{"id":"Unidata","name":"NSF Unidata","url":"https://www.unidata.ucar.edu"},{"id":"Argonne","name":"Argonne National Laboratory","department":"Environmental Science Division","url":"https://www.anl.gov/evs"},{"id":"CarbonPlan","name":"CarbonPlan","url":"https://carbonplan.org"},{"id":"NVIDIA","name":"NVIDIA Corporation","url":"https://www.nvidia.com/"}],"abbreviations":{"API":"Application Programming Interface","DOI":"Digital Object Identifier","FOSS":"Free and Open-Source Software","FTP":"File Transfer Protocol","HTTP":"Hypertext Transfer Protocol","ID":"Identifier","IDL":"Interactive Data Language","NCAR":"NSF National Center for Atmospheric Research","NCL":"NCAR Command Language","NSF":"U.S. National Science Foundation","PR":"Pull Request","SPE":"Scientific Python Ecosystem","SSH":"Secure Shell Protocol","TCP":"Transmission Control Protocol","VCS":"Version Control System"},"settings":{"output_matplotlib_strings":"remove"},"numbering":{"title":{"offset":2}},"source_url":"https://github.com/projectpythia/pythia-foundations/blob/main/core/xarray/enso-xarray.ipynb","edit_url":"https://github.com/projectpythia/pythia-foundations/edit/main/core/xarray/enso-xarray.ipynb","thumbnail":"/_preview/610/build/5b573c400006de55b13b7219b0eebaa5.gif","exports":[{"format":"ipynb","filename":"enso-xarray.ipynb","url":"/_preview/610/build/enso-xarray-233150964fcef34cff915e3d89bad48a.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"s7iSCSXdaq"}],"key":"gm98Il5XVx"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Overview","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CKSjuWphZQ"}],"identifier":"overview","label":"Overview","html_id":"overview","implicit":true,"key":"xk2brhjust"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"In this tutorial, we perform and demonstrate the following tasks:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"PS7N3cyP0z"}],"key":"Nqziw9ClHH"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Load SST data from the CESM2 model","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"mb9dGXEEFf"}],"key":"XghCOjLWV8"}],"key":"ix8RfD7iP9"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Mask data using ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"OxCZMHFST7"},{"type":"inlineCode","value":".where()","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"cRYZB5dJSd"}],"key":"kuiBrJO1yx"}],"key":"qY2PpYnkK5"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Compute climatologies and anomalies using ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"UBfUMj9Ez4"},{"type":"inlineCode","value":".groupby()","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"MfhOp9dBvm"}],"key":"HP8FzoVhx8"}],"key":"yGRtnqyUbn"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Use ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"tFg64obU8y"},{"type":"inlineCode","value":".rolling()","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"WmHSpdKpDC"},{"type":"text","value":" to compute moving average","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"UGpfGS9Yag"}],"key":"xCPM9Ncw2Q"}],"key":"HGVdZWdtgV"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Compute, normalize, and plot the Ni√±o 3.4 Index","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"cBWXwpHQP4"}],"key":"NiTk3bZ3YW"}],"key":"GyIVICpOCh"}],"key":"A95uOtueQ9"}],"key":"M6IHSXYufB"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Prerequisites","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"USggcyS0co"}],"identifier":"prerequisites","label":"Prerequisites","html_id":"prerequisites","implicit":true,"key":"cxlW5E4XMq"},{"type":"table","position":{"start":{"line":4,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"tableCell","header":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Concepts","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"GkwzOMIni2"}],"key":"Yj9GO8rPRy"},{"type":"tableCell","header":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Importance","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"giRMv2NbLP"}],"key":"lSJdv4JrJT"},{"type":"tableCell","header":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Notes","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"hOokEeysNt"}],"key":"ABKIXGu4ue"}],"key":"rOKkfrWq34"},{"type":"tableRow","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"link","url":"/core/xarray/xarray-intro","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Introduction to Xarray","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"PHQjRuRqpQ"}],"urlSource":"xarray-intro","dataUrl":"/core.xarray.xarray-intro.json","internal":true,"protocol":"file","key":"yp1G34k67z"}],"key":"ssh0cQo5g5"},{"type":"tableCell","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Necessary","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"wFQjWJfUk9"}],"key":"weKaoUS7lX"},{"type":"tableCell","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"citeGroup","kind":"narrative","children":[{"type":"cite","kind":"narrative","label":"hoyer2017xarray","identifier":"hoyer2017xarray","children":[{"type":"text","value":"Hoyer & Hamman (2017)","key":"pHp6g6gZgr"}],"enumerator":"1","key":"F9pNQL0tuE"}],"key":"eEaDvzNA7k"}],"key":"sYsJwqiCJw"}],"key":"VumoAy8K4i"},{"type":"tableRow","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"link","url":"/core/xarray/computation-masking","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Computation and Masking","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"R79oKsipfq"}],"urlSource":"computation-masking","dataUrl":"/core.xarray.computation-masking.json","internal":true,"protocol":"file","key":"VkhRu824Cv"}],"key":"Btac4qSzQ9"},{"type":"tableCell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Necessary","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"KYZbVyeC1l"}],"key":"qrXpNuKn50"},{"type":"tableCell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[],"key":"TGB3qigzFT"}],"key":"Wxin56wUH0"}],"key":"fOVbRrEvfv"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Time to learn","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"gq5YahIUjm"}],"key":"nqOZWIoJKI"},{"type":"text","value":": 20 minutes","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"RttYghpRfu"}],"key":"SbSlrmOwOh"}],"key":"ISG6j5C3l5"}],"key":"b1eajZ6SkM"}],"key":"UTB9pzSjex"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fk8ZX96eQj"}],"key":"BfxJbGLFnb"},{"type":"block","kind":"notebook-content","data":{"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Imports","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gDapLsKETs"}],"identifier":"imports","label":"Imports","html_id":"imports","implicit":true,"key":"rMSldNNAAU"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"For this tutorial, we import several Python packages. As plotting ENSO data requires a geographically accurate map, Cartopy is imported to handle geographic features and map projections. Xarray is used to manage raw data, and Matplotlib allows for feature-rich data plotting. Finally, a custom Pythia package is imported, in this case allowing access to the Pythia example data library.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"lsPrQw4Y92"}],"key":"ZM9KT9Fj6G"}],"visibility":"show","key":"h7E4cLO0T5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import cartopy.crs as ccrs\nimport matplotlib.pyplot as plt\nimport xarray as xr\nfrom pythia_datasets import DATASETS","key":"OIbw1tje3w"},{"type":"outputs","id":"aGETWQV_hS97aWF9bwwyL","children":[],"key":"y6Vj50fF7O"}],"key":"iJPQC0nfId"},{"type":"block","kind":"notebook-content","data":{"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The Ni√±o 3.4 Index","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CdL3R2tLh5"}],"identifier":"the-ni-o-3-4-index","label":"The Ni√±o 3.4 Index","html_id":"the-ni-o-3-4-index","implicit":true,"key":"QReeVpbLFg"}],"visibility":"show","key":"Fs3ihT6v3t"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"In this tutorial, we combine topics covered in previous Xarray tutorials to demonstrate a real-world example. The real-world scenario demonstrated in this tutorial is the computation of the ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"iChS6kvXJp"},{"type":"link","url":"https://climatedataguide.ucar.edu/climate-data/nino-sst-indices-nino-12-3-34-4-oni-and-tni","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Ni√±o 3.4 Index","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"Zre4dObG3X"}],"urlSource":"https://climatedataguide.ucar.edu/climate-data/nino-sst-indices-nino-12-3-34-4-oni-and-tni","key":"IN4wRm9zTp"},{"type":"text","value":", as shown in the CESM2 submission for the ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"NXS1NCWWOK"},{"type":"link","url":"https://esgf-node.llnl.gov/projects/cmip6/","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"CMIP6 project","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"I06zpFSstF"}],"urlSource":"https://esgf-node.llnl.gov/projects/cmip6/","key":"RCkvCGAEIU"},{"type":"text","value":". A rough definition of Ni√±o 3.4, in addition to a definition of Ni√±o data computation, is listed below:","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"twGxV7vn8C"}],"key":"YQLDhPVXmm"},{"type":"blockquote","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Ni√±o 3.4 (5N-5S, 170W-120W): The Ni√±o 3.4 anomalies may be thought of as representing the average equatorial SSTs across the Pacific from about the dateline to the South American coast. The Ni√±o 3.4 index typically uses a 5-month running mean, and El Ni√±o or La Ni√±a events are defined when the Ni√±o 3.4 SSTs exceed +/- 0.4C for a period of six months or more.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"abuD3H1EkD"}],"key":"jme5zp9XJ9"}],"key":"oNIRLrO5pR"},{"type":"blockquote","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Ni√±o X Index computation: a) Compute area averaged total SST from Ni√±o X region; b) Compute monthly climatology (e.g., 1950-1979) for area averaged total SST from Ni√±o X region, and subtract climatology from area averaged total SST time series to obtain anomalies; c) Smooth the anomalies with a 5-month running mean; d) Normalize the smoothed values by its standard deviation over the climatological period.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"puBAaCjiKo"}],"key":"dC4D4O7Cv6"}],"key":"PAt8p2AwXR"},{"type":"image","url":"/_preview/610/build/5b573c400006de55b13b7219b0eebaa5.gif","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"WPhx48YbBY","urlSource":"https://www.ncdc.noaa.gov/monitoring-content/teleconnections/nino-regions.gif"},{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"The overall goal of this tutorial is to produce a plot of ENSO data using Xarray; this plot will resemble the Oceanic Ni√±o Index plot shown below.","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"rnbmijXMpk"}],"key":"ekPJAmRoHE"},{"type":"image","url":"/_preview/610/build/09e5575f0933195e3498e3733096f7f7.png","alt":"ONI index plot from NCAR Climate Data Guide","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"Ry9kzf5oY8","urlSource":"https://climatedataguide.ucar.edu/sites/default/files/styles/extra_large/public/2022-03/indices_oni_2_2_lg.png"}],"key":"SF1FbQLNIk"},{"type":"block","kind":"notebook-content","data":{"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In this first example, we begin by opening datasets containing the sea-surface temperature (SST) and grid-cell size data. (These datasets are taken from the Pythia example data library, using the Pythia package imported above.) The two datasets are then combined into a single dataset using Xarray‚Äôs ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rAvY8aSopR"},{"type":"inlineCode","value":"merge","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rzVo6RRvM8"},{"type":"text","value":" method.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iIrpkw35ML"}],"key":"T3rEbeRYDQ"}],"visibility":"show","key":"oUJ99dIiPg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"filepath = DATASETS.fetch('CESM2_sst_data.nc')\ndata = xr.open_dataset(filepath)\nfilepath2 = DATASETS.fetch('CESM2_grid_variables.nc')\nareacello = xr.open_dataset(filepath2).areacello\n\nds = xr.merge([data, areacello])\nds","key":"E1G8qA3RRs"},{"type":"outputs","id":"K5oZymRbBntVmdx40hwyH","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"Downloading file 'CESM2_sst_data.nc' from 'https://github.com/ProjectPythia/pythia-datasets/raw/main/data/CESM2_sst_data.nc' to '/home/runner/.cache/pythia-datasets'.\n"},"key":"LTqfgHjE7I"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"/home/runner/micromamba/envs/pythia-book-dev/lib/python3.14/site-packages/xarray/conventions.py:204: SerializationWarning: variable 'tos' has multiple fill values {np.float32(1e+20), np.float64(1e+20)} defined, decoding all values to NaN.\n  var = coder.decode(var, name=name)\nDownloading file 'CESM2_grid_variables.nc' from 'https://github.com/ProjectPythia/pythia-datasets/raw/main/data/CESM2_grid_variables.nc' to '/home/runner/.cache/pythia-datasets'.\n"},"key":"e8f1Gm0W57"},{"type":"output","children":[],"jupyter_data":{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"text/plain":{"content":"<xarray.Dataset> Size: 47MB\nDimensions:    (time: 180, d2: 2, lat: 180, lon: 360)\nCoordinates:\n  * time       (time) object 1kB 2000-01-15 12:00:00 ... 2014-12-15 12:00:00\n  * lat        (lat) float64 1kB -89.5 -88.5 -87.5 -86.5 ... 86.5 87.5 88.5 89.5\n  * lon        (lon) float64 3kB 0.5 1.5 2.5 3.5 4.5 ... 356.5 357.5 358.5 359.5\nDimensions without coordinates: d2\nData variables:\n    time_bnds  (time, d2) object 3kB ...\n    lat_bnds   (lat, d2) float64 3kB ...\n    lon_bnds   (lon, d2) float64 6kB ...\n    tos        (time, lat, lon) float32 47MB ...\n    areacello  (lat, lon) float64 518kB ...\nAttributes: (12/45)\n    Conventions:            CF-1.7 CMIP-6.2\n    activity_id:            CMIP\n    branch_method:          standard\n    branch_time_in_child:   674885.0\n    branch_time_in_parent:  219000.0\n    case_id:                972\n    ...                     ...\n    sub_experiment_id:      none\n    table_id:               Omon\n    tracking_id:            hdl:21.14100/2975ffd3-1d7b-47e3-961a-33f212ea4eb2\n    variable_id:            tos\n    variant_info:           CMIP6 20th century experiments (1850-2014) with C...\n    variant_label:          r11i1p1f1","content_type":"text/plain"},"text/html":{"content_type":"text/html","hash":"db64431934844bf769f4922e1735dc7e","path":"/_preview/610/build/db64431934844bf769f4922e1735dc7e.html"}}},"key":"HH3tWjUfls"}],"key":"IMUvfVTVfH"}],"key":"OQgpXOBe6l"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This example uses Matplotlib and Cartopy to plot the first time slice of the dataset on an actual geographic map. By doing so, we verify that the data values fit the pattern of SST data:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nlk2dprtRx"}],"key":"gai3xn8AaI"}],"key":"BqyW7Pjhlx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"fig = plt.figure(figsize=(12, 6))\nax = plt.axes(projection=ccrs.Robinson(central_longitude=180))\nax.coastlines()\nax.gridlines()\nds.tos.isel(time=0).plot(\n    ax=ax, transform=ccrs.PlateCarree(), vmin=-2, vmax=30, cmap='coolwarm'\n);","key":"RSitRA2rVf"},{"type":"outputs","id":"5vOp5CCWt9d8f8ruhaEfS","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"/home/runner/micromamba/envs/pythia-book-dev/lib/python3.14/site-packages/cartopy/io/__init__.py:242: DownloadWarning: Downloading: https://naturalearth.s3.amazonaws.com/110m_physical/ne_110m_coastline.zip\n  warnings.warn(f'Downloading: {url}', DownloadWarning)\n"},"key":"YM8h6SdEpv"},{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 1200x600 with 2 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"6e9b3c78a3292aa06c2307fafb71534c","path":"/_preview/610/build/6e9b3c78a3292aa06c2307fafb71534c.png"}}},"key":"BmZwKvbluB"}],"key":"v8luirDJyv"}],"key":"WRlDUqp6bp"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Select the Ni√±o 3.4 region","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Pu5TLnTlXH"}],"identifier":"select-the-ni-o-3-4-region","label":"Select the Ni√±o 3.4 region","html_id":"select-the-ni-o-3-4-region","implicit":true,"key":"mR8AD3IVhz"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"In this set of examples, we demonstrate the selection of data values from a dataset which are located in the Ni√±o 3.4 geographic region. The following example illustrates a selection technique that uses the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Jt5QyxGymd"},{"type":"inlineCode","value":"sel()","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"gqjHDyZeNO"},{"type":"text","value":" or ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"MkgYlviDcu"},{"type":"inlineCode","value":"isel()","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"lQuUGoAfAq"},{"type":"text","value":" method:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"n94PyXNcAt"}],"key":"f7sCvgnbst"}],"key":"YRg3yPjlUJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"tos_nino34 = ds.sel(lat=slice(-5, 5), lon=slice(190, 240))\ntos_nino34","key":"HrnztpTB5W"},{"type":"outputs","id":"mL0bRuLGJ0WJnCApfrwYE","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/plain":{"content":"<xarray.Dataset> Size: 370kB\nDimensions:    (time: 180, d2: 2, lat: 10, lon: 50)\nCoordinates:\n  * time       (time) object 1kB 2000-01-15 12:00:00 ... 2014-12-15 12:00:00\n  * lat        (lat) float64 80B -4.5 -3.5 -2.5 -1.5 -0.5 0.5 1.5 2.5 3.5 4.5\n  * lon        (lon) float64 400B 190.5 191.5 192.5 193.5 ... 237.5 238.5 239.5\nDimensions without coordinates: d2\nData variables:\n    time_bnds  (time, d2) object 3kB ...\n    lat_bnds   (lat, d2) float64 160B ...\n    lon_bnds   (lon, d2) float64 800B ...\n    tos        (time, lat, lon) float32 360kB ...\n    areacello  (lat, lon) float64 4kB ...\nAttributes: (12/45)\n    Conventions:            CF-1.7 CMIP-6.2\n    activity_id:            CMIP\n    branch_method:          standard\n    branch_time_in_child:   674885.0\n    branch_time_in_parent:  219000.0\n    case_id:                972\n    ...                     ...\n    sub_experiment_id:      none\n    table_id:               Omon\n    tracking_id:            hdl:21.14100/2975ffd3-1d7b-47e3-961a-33f212ea4eb2\n    variable_id:            tos\n    variant_info:           CMIP6 20th century experiments (1850-2014) with C...\n    variant_label:          r11i1p1f1","content_type":"text/plain"},"text/html":{"content_type":"text/html","hash":"3f39522244bc215b8ead371d7fb041a0","path":"/_preview/610/build/3f39522244bc215b8ead371d7fb041a0.html"}}},"key":"BkpZMGhqmk"}],"key":"I1ix1fIS9A"}],"key":"WJrCs0H5iC"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This example illustrates the alternate technique for selecting Ni√±o 3.4 data, which makes use of the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wO4dwmV7vH"},{"type":"inlineCode","value":"where()","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gzorD60XzD"},{"type":"text","value":" method:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rYKhOSmteW"}],"key":"opCvVA03ZE"}],"key":"jO68WkPpQA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"tos_nino34 = ds.where(\n    (ds.lat < 5) & (ds.lat > -5) & (ds.lon > 190) & (ds.lon < 240), drop=True\n)\ntos_nino34","key":"RxFenAQ32t"},{"type":"outputs","id":"UP9BzP5_b8K2NegjZprC9","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"text/plain":{"content":"<xarray.Dataset> Size: 2MB\nDimensions:    (time: 180, d2: 2, lat: 10, lon: 50)\nCoordinates:\n  * time       (time) object 1kB 2000-01-15 12:00:00 ... 2014-12-15 12:00:00\n  * lat        (lat) float64 80B -4.5 -3.5 -2.5 -1.5 -0.5 0.5 1.5 2.5 3.5 4.5\n  * lon        (lon) float64 400B 190.5 191.5 192.5 193.5 ... 237.5 238.5 239.5\nDimensions without coordinates: d2\nData variables:\n    time_bnds  (time, d2, lat, lon) object 1MB 2000-01-01 00:00:00 ... 2015-0...\n    lat_bnds   (lat, d2, lon) float64 8kB -5.0 -5.0 -5.0 -5.0 ... 5.0 5.0 5.0\n    lon_bnds   (lon, d2, lat) float64 8kB 190.0 190.0 190.0 ... 240.0 240.0\n    tos        (time, lat, lon) float32 360kB 28.26 28.16 28.06 ... 28.57 28.63\n    areacello  (lat, lon) float64 4kB 1.233e+10 1.233e+10 ... 1.233e+10\nAttributes: (12/45)\n    Conventions:            CF-1.7 CMIP-6.2\n    activity_id:            CMIP\n    branch_method:          standard\n    branch_time_in_child:   674885.0\n    branch_time_in_parent:  219000.0\n    case_id:                972\n    ...                     ...\n    sub_experiment_id:      none\n    table_id:               Omon\n    tracking_id:            hdl:21.14100/2975ffd3-1d7b-47e3-961a-33f212ea4eb2\n    variable_id:            tos\n    variant_info:           CMIP6 20th century experiments (1850-2014) with C...\n    variant_label:          r11i1p1f1","content_type":"text/plain"},"text/html":{"content_type":"text/html","hash":"82f08dd64c966ef3d77120f9382c4c78","path":"/_preview/610/build/82f08dd64c966ef3d77120f9382c4c78.html"}}},"key":"JYvbrCZ6gc"}],"key":"YXXpD91eIo"}],"key":"qotarPiM8d"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Finally, we plot the selected region to ensure it fits the definition of the Ni√±o 3.4 region:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HB6yv0plOS"}],"key":"yiyxSUTEr6"}],"key":"JDXOJ5wH74"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"fig = plt.figure(figsize=(12, 6))\nax = plt.axes(projection=ccrs.Robinson(central_longitude=180))\nax.coastlines()\nax.gridlines()\ntos_nino34.tos.isel(time=0).plot(\n    ax=ax, transform=ccrs.PlateCarree(), vmin=-2, vmax=30, cmap='coolwarm'\n)\nax.set_extent((120, 300, 10, -10))","key":"ACCDw3MJyg"},{"type":"outputs","id":"V9gGoLphz3pojH0igVRXH","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 1200x600 with 2 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"c2c402dec91244d31604a05cb22898fa","path":"/_preview/610/build/c2c402dec91244d31604a05cb22898fa.png"}}},"key":"l9FQgLCAvd"}],"key":"Nin7NQXBS7"}],"key":"D3Nu8gzs7t"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Compute the anomalies","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KFBSMTlXxP"}],"identifier":"compute-the-anomalies","label":"Compute the anomalies","html_id":"compute-the-anomalies","implicit":true,"key":"rHhiveP0Xn"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"There are three main steps to obtain the anomalies from the Ni√±o 3.4 dataset created in the previous set of examples. First, we use the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"vNvaUZhYjv"},{"type":"inlineCode","value":"groupby()","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"OtkFXEgX4h"},{"type":"text","value":" method to convert to monthly data. Second, we subtract the mean sea-surface temperature (SST) from the monthly data. Finally, we obtain the anomalies by computing a weighted average. These steps are illustrated in the next example:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Ejodte4gYN"}],"key":"yAjzxRS4Wt"}],"key":"v0CL3aWhIJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"gb = tos_nino34.tos.groupby('time.month')\ntos_nino34_anom = gb - gb.mean(dim='time')\nindex_nino34 = tos_nino34_anom.weighted(tos_nino34.areacello).mean(dim=['lat', 'lon'])","key":"Ecgb771KD4"},{"type":"outputs","id":"A9qYJlK5IuPBdwASIhOKS","children":[],"key":"Y8DkzpfylJ"}],"key":"AqGqkrHEmv"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In this example, we smooth the data curve by applying a ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Yb5nmTatkT"},{"type":"inlineCode","value":"mean","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Ub2OxrBM2m"},{"type":"text","value":" function with a 5-month moving window to the anomaly dataset. We then plot the smoothed data against the original data to demonstrate:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"K0gxoHt1Yi"}],"key":"ZGIaz4YZTW"}],"key":"WKPIVSYko8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"index_nino34_rolling_mean = index_nino34.rolling(time=5, center=True).mean()","key":"MfhIc9Cjvo"},{"type":"outputs","id":"i9BnBG7m6Tp3ds7W_xZR0","children":[],"key":"YAshiEMnNL"}],"key":"RDQi8qXGJq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"index_nino34.plot(size=8)\nindex_nino34_rolling_mean.plot()\nplt.legend(['anomaly', '5-month running mean anomaly'])\nplt.title('SST anomaly over the Ni√±o 3.4 region');","key":"cWoQZ9wUTd"},{"type":"outputs","id":"YRZ-3yK-buNwTLk16CBue","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 1066.67x800 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"9c2bc8eb4e19e32c2f9dfe4154c40e1c","path":"/_preview/610/build/9c2bc8eb4e19e32c2f9dfe4154c40e1c.png"}}},"key":"qEFa9s9AwC"}],"key":"YokxJKmA9l"}],"key":"PLxspwrr8X"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Since the ENSO index conveys deviations from a norm, the calculation of Ni√±o data requires a standard deviation. In this example, we calculate the standard deviation of the SST in the Ni√±o 3.4 region data, across the entire time period of the data array:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nsff4vgaTH"}],"key":"d5H88R7ZVb"}],"key":"DY5NVlorRQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"std_dev = tos_nino34.tos.std()\nstd_dev","key":"oDqXy9jn1h"},{"type":"outputs","id":"hsy0Ku_XwaZlMVVp8fDyu","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"execute_result","execution_count":10,"metadata":{},"data":{"text/plain":{"content":"<xarray.DataArray 'tos' ()> Size: 4B\narray(1.8436453, dtype=float32)\nAttributes: (12/19)\n    cell_measures:  area: areacello\n    cell_methods:   area: mean where sea time: mean\n    comment:        Model data on the 1x1 grid includes values in all cells f...\n    description:    This may differ from \"surface temperature\" in regions of ...\n    frequency:      mon\n    id:             tos\n    ...             ...\n    time_label:     time-mean\n    time_title:     Temporal mean\n    title:          Sea Surface Temperature\n    type:           real\n    units:          degC\n    variable_id:    tos","content_type":"text/plain"},"text/html":{"content":"<div><svg style=\"position: absolute; width: 0; height: 0; overflow: hidden\">\n<defs>\n<symbol id=\"icon-database\" viewBox=\"0 0 32 32\">\n<path d=\"M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z\"></path>\n<path d=\"M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n<path d=\"M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n</symbol>\n<symbol id=\"icon-file-text2\" viewBox=\"0 0 32 32\">\n<path d=\"M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z\"></path>\n<path d=\"M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n</symbol>\n</defs>\n</svg>\n<style>/* CSS stylesheet for displaying xarray objects in notebooks */\n\n:root {\n  --xr-font-color0: var(\n    --jp-content-font-color0,\n    var(--pst-color-text-base rgba(0, 0, 0, 1))\n  );\n  --xr-font-color2: var(\n    --jp-content-font-color2,\n    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))\n  );\n  --xr-font-color3: var(\n    --jp-content-font-color3,\n    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))\n  );\n  --xr-border-color: var(\n    --jp-border-color2,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))\n  );\n  --xr-disabled-color: var(\n    --jp-layout-color3,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))\n  );\n  --xr-background-color: var(\n    --jp-layout-color0,\n    var(--pst-color-on-background, white)\n  );\n  --xr-background-color-row-even: var(\n    --jp-layout-color1,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))\n  );\n  --xr-background-color-row-odd: var(\n    --jp-layout-color2,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))\n  );\n}\n\nhtml[theme=\"dark\"],\nhtml[data-theme=\"dark\"],\nbody[data-theme=\"dark\"],\nbody.vscode-dark {\n  --xr-font-color0: var(\n    --jp-content-font-color0,\n    var(--pst-color-text-base, rgba(255, 255, 255, 1))\n  );\n  --xr-font-color2: var(\n    --jp-content-font-color2,\n    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))\n  );\n  --xr-font-color3: var(\n    --jp-content-font-color3,\n    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))\n  );\n  --xr-border-color: var(\n    --jp-border-color2,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))\n  );\n  --xr-disabled-color: var(\n    --jp-layout-color3,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))\n  );\n  --xr-background-color: var(\n    --jp-layout-color0,\n    var(--pst-color-on-background, #111111)\n  );\n  --xr-background-color-row-even: var(\n    --jp-layout-color1,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))\n  );\n  --xr-background-color-row-odd: var(\n    --jp-layout-color2,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))\n  );\n}\n\n.xr-wrap {\n  display: block !important;\n  min-width: 300px;\n  max-width: 700px;\n  line-height: 1.6;\n  padding-bottom: 4px;\n}\n\n.xr-text-repr-fallback {\n  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */\n  display: none;\n}\n\n.xr-header {\n  padding-top: 6px;\n  padding-bottom: 6px;\n}\n\n.xr-header {\n  border-bottom: solid 1px var(--xr-border-color);\n  margin-bottom: 4px;\n}\n\n.xr-header > div,\n.xr-header > ul {\n  display: inline;\n  margin-top: 0;\n  margin-bottom: 0;\n}\n\n.xr-obj-type,\n.xr-obj-name {\n  margin-left: 2px;\n  margin-right: 10px;\n}\n\n.xr-obj-type,\n.xr-group-box-contents > label {\n  color: var(--xr-font-color2);\n  display: block;\n}\n\n.xr-sections {\n  padding-left: 0 !important;\n  display: grid;\n  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;\n  margin-block-start: 0;\n  margin-block-end: 0;\n}\n\n.xr-section-item {\n  display: contents;\n}\n\n.xr-section-item > input,\n.xr-group-box-contents > input,\n.xr-array-wrap > input {\n  display: block;\n  opacity: 0;\n  height: 0;\n  margin: 0;\n}\n\n.xr-section-item > input + label,\n.xr-var-item > input + label {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-item > input:enabled + label,\n.xr-var-item > input:enabled + label,\n.xr-array-wrap > input:enabled + label,\n.xr-group-box-contents > input:enabled + label {\n  cursor: pointer;\n  color: var(--xr-font-color2);\n}\n\n.xr-section-item > input:focus-visible + label,\n.xr-var-item > input:focus-visible + label,\n.xr-array-wrap > input:focus-visible + label,\n.xr-group-box-contents > input:focus-visible + label {\n  outline: auto;\n}\n\n.xr-section-item > input:enabled + label:hover,\n.xr-var-item > input:enabled + label:hover,\n.xr-array-wrap > input:enabled + label:hover,\n.xr-group-box-contents > input:enabled + label:hover {\n  color: var(--xr-font-color0);\n}\n\n.xr-section-summary {\n  grid-column: 1;\n  color: var(--xr-font-color2);\n  font-weight: 500;\n  white-space: nowrap;\n}\n\n.xr-section-summary > em {\n  font-weight: normal;\n}\n\n.xr-span-grid {\n  grid-column-end: -1;\n}\n\n.xr-section-summary > span {\n  display: inline-block;\n  padding-left: 0.3em;\n}\n\n.xr-group-box-contents > input:checked + label > span {\n  display: inline-block;\n  padding-left: 0.6em;\n}\n\n.xr-section-summary-in:disabled + label {\n  color: var(--xr-font-color2);\n}\n\n.xr-section-summary-in + label:before {\n  display: inline-block;\n  content: \"‚ñ∫\";\n  font-size: 11px;\n  width: 15px;\n  text-align: center;\n}\n\n.xr-section-summary-in:disabled + label:before {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-summary-in:checked + label:before {\n  content: \"‚ñº\";\n}\n\n.xr-section-summary-in:checked + label > span {\n  display: none;\n}\n\n.xr-section-summary,\n.xr-section-inline-details,\n.xr-group-box-contents > label {\n  padding-top: 4px;\n}\n\n.xr-section-inline-details {\n  grid-column: 2 / -1;\n}\n\n.xr-section-details {\n  grid-column: 1 / -1;\n  margin-top: 4px;\n  margin-bottom: 5px;\n}\n\n.xr-section-summary-in ~ .xr-section-details {\n  display: none;\n}\n\n.xr-section-summary-in:checked ~ .xr-section-details {\n  display: contents;\n}\n\n.xr-children {\n  display: inline-grid;\n  grid-template-columns: 100%;\n  grid-column: 1 / -1;\n  padding-top: 4px;\n}\n\n.xr-group-box {\n  display: inline-grid;\n  grid-template-columns: 0px 30px auto;\n}\n\n.xr-group-box-vline {\n  grid-column-start: 1;\n  border-right: 0.2em solid;\n  border-color: var(--xr-border-color);\n  width: 0px;\n}\n\n.xr-group-box-hline {\n  grid-column-start: 2;\n  grid-row-start: 1;\n  height: 1em;\n  width: 26px;\n  border-bottom: 0.2em solid;\n  border-color: var(--xr-border-color);\n}\n\n.xr-group-box-contents {\n  grid-column-start: 3;\n  padding-bottom: 4px;\n}\n\n.xr-group-box-contents > label::before {\n  content: \"üìÇ\";\n  padding-right: 0.3em;\n}\n\n.xr-group-box-contents > input:checked + label::before {\n  content: \"üìÅ\";\n}\n\n.xr-group-box-contents > input:checked + label {\n  padding-bottom: 0px;\n}\n\n.xr-group-box-contents > input:checked ~ .xr-sections {\n  display: none;\n}\n\n.xr-group-box-contents > input + label > span {\n  display: none;\n}\n\n.xr-group-box-ellipsis {\n  font-size: 1.4em;\n  font-weight: 900;\n  color: var(--xr-font-color2);\n  letter-spacing: 0.15em;\n  cursor: default;\n}\n\n.xr-array-wrap {\n  grid-column: 1 / -1;\n  display: grid;\n  grid-template-columns: 20px auto;\n}\n\n.xr-array-wrap > label {\n  grid-column: 1;\n  vertical-align: top;\n}\n\n.xr-preview {\n  color: var(--xr-font-color3);\n}\n\n.xr-array-preview,\n.xr-array-data {\n  padding: 0 5px !important;\n  grid-column: 2;\n}\n\n.xr-array-data,\n.xr-array-in:checked ~ .xr-array-preview {\n  display: none;\n}\n\n.xr-array-in:checked ~ .xr-array-data,\n.xr-array-preview {\n  display: inline-block;\n}\n\n.xr-dim-list {\n  display: inline-block !important;\n  list-style: none;\n  padding: 0 !important;\n  margin: 0;\n}\n\n.xr-dim-list li {\n  display: inline-block;\n  padding: 0;\n  margin: 0;\n}\n\n.xr-dim-list:before {\n  content: \"(\";\n}\n\n.xr-dim-list:after {\n  content: \")\";\n}\n\n.xr-dim-list li:not(:last-child):after {\n  content: \",\";\n  padding-right: 5px;\n}\n\n.xr-has-index {\n  font-weight: bold;\n}\n\n.xr-var-list,\n.xr-var-item {\n  display: contents;\n}\n\n.xr-var-item > div,\n.xr-var-item label,\n.xr-var-item > .xr-var-name span {\n  background-color: var(--xr-background-color-row-even);\n  border-color: var(--xr-background-color-row-odd);\n  margin-bottom: 0;\n  padding-top: 2px;\n}\n\n.xr-var-item > .xr-var-name:hover span {\n  padding-right: 5px;\n}\n\n.xr-var-list > li:nth-child(odd) > div,\n.xr-var-list > li:nth-child(odd) > label,\n.xr-var-list > li:nth-child(odd) > .xr-var-name span {\n  background-color: var(--xr-background-color-row-odd);\n  border-color: var(--xr-background-color-row-even);\n}\n\n.xr-var-name {\n  grid-column: 1;\n}\n\n.xr-var-dims {\n  grid-column: 2;\n}\n\n.xr-var-dtype {\n  grid-column: 3;\n  text-align: right;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-preview {\n  grid-column: 4;\n}\n\n.xr-index-preview {\n  grid-column: 2 / 5;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-name,\n.xr-var-dims,\n.xr-var-dtype,\n.xr-preview,\n.xr-attrs dt {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding-right: 10px;\n}\n\n.xr-var-name:hover,\n.xr-var-dims:hover,\n.xr-var-dtype:hover,\n.xr-attrs dt:hover {\n  overflow: visible;\n  width: auto;\n  z-index: 1;\n}\n\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  display: none;\n  border-top: 2px dotted var(--xr-background-color);\n  padding-bottom: 20px !important;\n  padding-top: 10px !important;\n}\n\n.xr-var-attrs-in + label,\n.xr-var-data-in + label,\n.xr-index-data-in + label {\n  padding: 0 1px;\n}\n\n.xr-var-attrs-in:checked ~ .xr-var-attrs,\n.xr-var-data-in:checked ~ .xr-var-data,\n.xr-index-data-in:checked ~ .xr-index-data {\n  display: block;\n}\n\n.xr-var-data > table {\n  float: right;\n}\n\n.xr-var-data > pre,\n.xr-index-data > pre,\n.xr-var-data > table > tbody > tr {\n  background-color: transparent !important;\n}\n\n.xr-var-name span,\n.xr-var-data,\n.xr-index-name div,\n.xr-index-data,\n.xr-attrs {\n  padding-left: 25px !important;\n}\n\n.xr-attrs,\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  grid-column: 1 / -1;\n}\n\ndl.xr-attrs {\n  padding: 0;\n  margin: 0;\n  display: grid;\n  grid-template-columns: 125px auto;\n}\n\n.xr-attrs dt,\n.xr-attrs dd {\n  padding: 0;\n  margin: 0;\n  float: left;\n  padding-right: 10px;\n  width: auto;\n}\n\n.xr-attrs dt {\n  font-weight: normal;\n  grid-column: 1;\n}\n\n.xr-attrs dt:hover span {\n  display: inline-block;\n  background: var(--xr-background-color);\n  padding-right: 10px;\n}\n\n.xr-attrs dd {\n  grid-column: 2;\n  white-space: pre-wrap;\n  word-break: break-all;\n}\n\n.xr-icon-database,\n.xr-icon-file-text2,\n.xr-no-icon {\n  display: inline-block;\n  vertical-align: middle;\n  width: 1em;\n  height: 1.5em !important;\n  stroke-width: 0;\n  stroke: currentColor;\n  fill: currentColor;\n}\n\n.xr-var-attrs-in:checked + label > .xr-icon-file-text2,\n.xr-var-data-in:checked + label > .xr-icon-database,\n.xr-index-data-in:checked + label > .xr-icon-database {\n  color: var(--xr-font-color0);\n  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));\n  stroke-width: 0.8px;\n}\n</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;tos&#x27; ()&gt; Size: 4B\narray(1.8436453, dtype=float32)\nAttributes: (12/19)\n    cell_measures:  area: areacello\n    cell_methods:   area: mean where sea time: mean\n    comment:        Model data on the 1x1 grid includes values in all cells f...\n    description:    This may differ from &quot;surface temperature&quot; in regions of ...\n    frequency:      mon\n    id:             tos\n    ...             ...\n    time_label:     time-mean\n    time_title:     Temporal mean\n    title:          Sea Surface Temperature\n    type:           real\n    units:          degC\n    variable_id:    tos</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-obj-name'>&#x27;tos&#x27;</div></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-3ac5c324-5b42-45da-8dd8-146cfb38664e' class='xr-array-in' type='checkbox' checked><label for='section-3ac5c324-5b42-45da-8dd8-146cfb38664e' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>1.844</span></div><div class='xr-array-data'><pre>array(1.8436453, dtype=float32)</pre></div></div></li><li class='xr-section-item'><input id='section-2b485c97-5e5e-4b23-9233-c6261d40066b' class='xr-section-summary-in' type='checkbox' /><label for='section-2b485c97-5e5e-4b23-9233-c6261d40066b' class='xr-section-summary' title='Expand/collapse section'>Attributes: <span>(19)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>cell_measures :</span></dt><dd>area: areacello</dd><dt><span>cell_methods :</span></dt><dd>area: mean where sea time: mean</dd><dt><span>comment :</span></dt><dd>Model data on the 1x1 grid includes values in all cells for which ocean cells on the native grid cover more than 52.5 percent of the 1x1 grid cell. This 52.5 percent cutoff was chosen to produce ocean surface area on the 1x1 grid as close as possible to ocean surface area on the native grid, while not introducing fractional cell coverage.</dd><dt><span>description :</span></dt><dd>This may differ from &quot;surface temperature&quot; in regions of sea ice or floating ice shelves. For models using conservative temperature as the prognostic field, they should report the top ocean layer as surface potential temperature, which is the same as surface in situ temperature.</dd><dt><span>frequency :</span></dt><dd>mon</dd><dt><span>id :</span></dt><dd>tos</dd><dt><span>long_name :</span></dt><dd>Sea Surface Temperature</dd><dt><span>mipTable :</span></dt><dd>Omon</dd><dt><span>out_name :</span></dt><dd>tos</dd><dt><span>prov :</span></dt><dd>Omon ((isd.003))</dd><dt><span>realm :</span></dt><dd>ocean</dd><dt><span>standard_name :</span></dt><dd>sea_surface_temperature</dd><dt><span>time :</span></dt><dd>time</dd><dt><span>time_label :</span></dt><dd>time-mean</dd><dt><span>time_title :</span></dt><dd>Temporal mean</dd><dt><span>title :</span></dt><dd>Sea Surface Temperature</dd><dt><span>type :</span></dt><dd>real</dd><dt><span>units :</span></dt><dd>degC</dd><dt><span>variable_id :</span></dt><dd>tos</dd></dl></div></li></ul></div></div>","content_type":"text/html"}}},"key":"dpb5hWc0xU"}],"key":"zrTHwKJNRg"}],"key":"kB2HP3BwwG"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The final step of the Ni√±o 3.4 index calculation involves normalizing the data. In this example, we perform this normalization by dividing the smoothed anomaly data by the standard deviation calculated above:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CSvEllGoFR"}],"key":"FXRgep94LD"}],"key":"cumhD3t1pF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"normalized_index_nino34_rolling_mean = index_nino34_rolling_mean / std_dev","key":"PaCc4MRsAd"},{"type":"outputs","id":"5i6R9B8QVVue-0fWW5NZl","children":[],"key":"txXahmtLup"}],"key":"YasJA1SlgC"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Visualize the computed Ni√±o 3.4 index","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"APfEaqU2ma"}],"identifier":"visualize-the-computed-ni-o-3-4-index","label":"Visualize the computed Ni√±o 3.4 index","html_id":"visualize-the-computed-ni-o-3-4-index","implicit":true,"key":"Vhg6qayH8H"}],"key":"kPgkxOy6e4"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In this example, we use Matplotlib to generate a plot of our final Ni√±o 3.4 data. This plot is set up to highlight values above 0.5, corresponding to El Ni√±o (warm) events, and values below -0.5, corresponding to La Ni√±a (cold) events.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RFFqTX1fno"}],"key":"X6k2wT0uEo"}],"key":"ccSjfwrO7y"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"fig = plt.figure(figsize=(12, 6))\n\nplt.fill_between(\n    normalized_index_nino34_rolling_mean.time.data,\n    normalized_index_nino34_rolling_mean.where(\n        normalized_index_nino34_rolling_mean >= 0.4\n    ).data,\n    0.4,\n    color='red',\n    alpha=0.9,\n)\nplt.fill_between(\n    normalized_index_nino34_rolling_mean.time.data,\n    normalized_index_nino34_rolling_mean.where(\n        normalized_index_nino34_rolling_mean <= -0.4\n    ).data,\n    -0.4,\n    color='blue',\n    alpha=0.9,\n)\n\nnormalized_index_nino34_rolling_mean.plot(color='black')\nplt.axhline(0, color='black', lw=0.5)\nplt.axhline(0.4, color='black', linewidth=0.5, linestyle='dotted')\nplt.axhline(-0.4, color='black', linewidth=0.5, linestyle='dotted')\nplt.title('Ni√±o 3.4 Index');","key":"jdX57jUx3u"},{"type":"outputs","id":"kpQ_YstrVeWU9wlTD6ZJU","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 1200x600 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"9e2f5db86394753b5127586e32f088db","path":"/_preview/610/build/9e2f5db86394753b5127586e32f088db.png"}}},"key":"l3t4SlttYS"}],"key":"Xio2Rza3ld"}],"key":"sKgrltMCM4"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hBMm2KndCc"}],"key":"QKDnFkbZBn"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Summary","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VfIkKVnXIn"}],"identifier":"summary","label":"Summary","html_id":"summary","implicit":true,"key":"ifvi0cp183"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"This tutorial covered the use of Xarray features, including selection, grouping, and statistical functions, to compute and visualize a data index important to climate science.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"N02hqxWZ5a"}],"key":"M8Yx9syy8m"}],"key":"t3wg9K7X6x"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Additional Resources","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ibaG7Ovw3X"}],"identifier":"additional-resources","label":"Additional Resources","html_id":"additional-resources","implicit":true,"key":"k1NXiig5uT"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","url":"https://climatedataguide.ucar.edu/climate-data/nino-sst-indices-nino-12-3-34-4-oni-and-tni","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Ni√±o 3.4 index","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"uiaJht5mgr"}],"urlSource":"https://climatedataguide.ucar.edu/climate-data/nino-sst-indices-nino-12-3-34-4-oni-and-tni","key":"L0AFBSuq08"}],"key":"roGrJ4xHFG"}],"key":"wycL6Qhvdd"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","url":"https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.fill_between.html","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Matplotlib‚Äôs ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"ToOK6TpNOl"},{"type":"inlineCode","value":"fill_between","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"zS69s6ikmg"},{"type":"text","value":" method","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"lmsPo6X34T"}],"urlSource":"https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.fill_between.html","key":"mQooqE9s6F"}],"key":"hy9ApDvtRB"}],"key":"Z9JxBVEQmY"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","url":"https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.axhline.html","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Matplotlib‚Äôs ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"VQGp3kUPkw"},{"type":"inlineCode","value":"axhline","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"uN5RY5ZRGc"},{"type":"text","value":" method","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"TZDBAYMpCc"}],"urlSource":"https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.axhline.html","key":"eSqPRV62uE"},{"type":"text","value":" (see also its analogous ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"CzimGPd2cn"},{"type":"inlineCode","value":"axvline","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"qOpkzaAhaD"},{"type":"text","value":" method)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"OpeCQlyzUu"}],"key":"HPzjhXMUn5"}],"key":"mfnaIcEaMp"}],"key":"HO0N6IDzHd"}],"key":"LcbpCGOD9k"}],"key":"xaCtCMOKBs"},"references":{"cite":{"order":["hoyer2017xarray"],"data":{"hoyer2017xarray":{"label":"hoyer2017xarray","enumerator":"1","doi":"10.5334/jors.148","html":"Hoyer, S., & Hamman, J. (2017). xarray: N-D labeled arrays and datasets in Python. <i>Journal of Open Research Software</i>, <i>5</i>(1). <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.5334/jors.148\">10.5334/jors.148</a>","url":"https://doi.org/10.5334/jors.148"}}}},"footer":{"navigation":{"prev":{"title":"Computations and Masks with Xarray","url":"/core/xarray/computation-masking","group":"Core Scientific Python Packages"},"next":{"title":"Dask Arrays with Xarray","url":"/core/xarray/dask-arrays-xarray","group":"Core Scientific Python Packages"}}},"domain":"http://localhost:3000"}